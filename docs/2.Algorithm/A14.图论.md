---
id : A12.å›¾è®º
title : A12.å›¾è®º
typora-root-url : ../ 
---

# å›¾è®º

### å›¾

å›¾:è‹¥å¹²ç›¸è¿çš„èŠ‚ç‚¹æ„æˆçš„é›†åˆ 

#### åŸºç¡€å®šä¹‰

$G =<V,E>$

1. æœ‰é™é›†åˆV:é¡¶ç‚¹(vertex); 
2. æœ‰é™é›†åˆE:è¾¹(edge);
3. é¡¶ç‚¹å¯¹(u,v):uä¸vä¸ºè¾¹(u,v)çš„ç«¯ç‚¹(endpoint);uå’Œvç›¸äº’é‚»æ¥(adjacent)
4. æœ‰å‘è¾¹:é¡¶ç‚¹å¯¹(u,v)ä¸ç­‰åŒäº(v,u); $u \to v$ : uä¸ºå°¾,vå°¾å¤´
5. æœ‰å‘å›¾(digraph):æ‰€æœ‰è¾¹æœ‰å‘ï¼Œegï¼šæœ‹å‹å…³ç³»çš„å›¾å’Œè·¯çº¿å›¾
6. æ— å‘å›¾(undirected graph):æ‰€æœ‰è¾¹æ— å‘ï¼Œegï¼šè¡¨ç¤ºæ•°å€¼çš„å¤§å°å…³ç³»çš„å›¾å’Œæµç¨‹å›¾
7. å®Œå…¨å›¾(complete):ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ç›¸è¿,$K_{|V|}, |E| = \frac {|V| \times (|V| - 1)}{2}$
8. ç¨ å¯†å›¾(dense):
9. ç¨€ç–å›¾(sparse):
10. è¾¹çš„æƒé‡æˆ–æˆæœ¬:æœ‰å‘è¾¹çš„å€¼

#### æ— å‘å›¾çš„æœ¯è¯­

ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´å¦‚æœæœ‰è¾¹è¿æ¥ ï¼Œé‚£ä¹ˆå°±è§†ä¸ºä¸¤ä¸ªé¡¶ç‚¹ç›¸é‚»ã€‚

ç›¸é‚»é¡¶ç‚¹çš„åºåˆ—ç§°ä¸ºè·¯å¾„ ã€‚

èµ·ç‚¹å’Œç»ˆç‚¹é‡åˆçš„è·¯å¾„å«åšåœˆ ã€‚

ä»»æ„ä¸¤ç‚¹ä¹‹é—´éƒ½æœ‰è·¯å¾„è¿æ¥çš„å›¾å«åšè¿é€šå›¾ã€‚

é¡¶ç‚¹è¿æ¥çš„è¾¹æ•°å«åšè¿™ä¸ªé¡¶ç‚¹çš„åº¦ã€‚

æ²¡æœ‰åœˆçš„è¿é€šå›¾å«åšæ ‘ï¼ˆtree), æ²¡æœ‰åœˆçš„éè¿é€šå›¾å«åšæ£®æ—ã€‚

#### æœ‰å‘å›¾çš„æœ¯è¯­

æœ‰å‘å›¾çš„é¡¶ç‚¹ v ä¸ºèµ·ç‚¹çš„è¾¹çš„é›†åˆè®°ä½œ $\delta_+(v)$, ä»¥é¡¶ç‚¹ v ä¸ºç»ˆç‚¹çš„è¾¹çš„é›†åˆè®°ä½œ $\delta_-(v)$ã€‚

 $|\delta_+(v)|$å«åš v çš„å‡ºåº¦ï¼Œ$|\delta_-(v)|$å«åšvçš„å…¥åº¦ã€‚

æ²¡æœ‰åœˆçš„æœ‰å‘å›¾å«åš DAG( Directed Acyclic Graph)

å¯¹äºæ¯ä¸ªé¡¶ç‚¹æˆ‘ä»¬ç»™å®ƒä¸€ä¸ªç¼–å· ï¼Œç¬¬ i å·é¡¶ç‚¹å«åš $v_i$ é‚£ ä¹ˆå­˜åœ¨ä»é¡¶ç‚¹ $v_i$, åˆ°é¡¶ç‚¹ $v_j$ çš„è¾¹æ—¶å°±æœ‰ $i < j$ ç«‹ ï¼Œè¿™ æ ·çš„ç¼–å·æ–¹å¼å«åšæ‹“æ‰‘åºï¼Œæ±‚è§£æ‹“æ‰‘åºçš„ç®—æ³•å«åšæ‹“æ‰‘æ’åºã€‚

#### è·¯å¾„å’Œç¯

**åºåˆ—**:å›¾Gä¸­,å§‹äºu,æ­¢äºvçš„é‚»æ¥

**ç®€å•è·¯å¾„**:è·¯å¾„ä¸Šæ‰€æœ‰é¡¶ç‚¹ä¸åŒ

**è¿é€š**:å›¾Gä¸­ä»»æ„ä¸€å¯¹(u,v)éƒ½æœ‰ä»uåˆ°vçš„è·¯å¾„

**è¿é€šåˆ†é‡**:éè¿é€šå›¾ä¸­,æå¤§è¿é€šå­å›¾



#### å›¾çš„è¡¨ç¤º

#### é‚»æ¥çŸ©é˜µ(adjacent matrix)

- æ— å‘å›¾ä¸­åªéœ€ä¿¡æ¯â€œé¡¶ç‚¹ i é¡¶ç‚¹ j ä¹‹é—´æ˜¯å¦æœ‰è¾¹è¿ç€â€ 
- æœ‰å‘å›¾åªéœ€ä¿¡æ¯â€œæ˜¯å¦æœ‰ä»é¡¶ç‚¹ i å‘å‡ºæŒ‡å‘é¡¶ç‚¹ j çš„è¾¹â€ 
- æ­¤å¤–ä¸¤ç‚¹ä¹‹é—´æœ‰é‡è¾¹æˆ–è€…æŸä¸ªé¡¶ç‚¹æœ‰è‡ªç¯
  - åœ¨æ— æƒå›¾ä¸­ï¼Œåªéœ€è¦è®¾ $g[i][j]$ ä¸ºé¡¶ç‚¹ i åˆ°é¡¶ç‚¹ j çš„è¾¹æ•°å³å¯ 
  - åœ¨å¸¦æƒå›¾ä¸­ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªéœ€è¦ä¿å­˜æƒå€¼æœ€å° ï¼ˆæœ€å¤§ ï¼‰ çš„è¾¹ï¼Œæ— è§†å…¶ä»–çš„è¾¹ã€‚
  - å¿…é¡»ä¿å­˜æ‰€æœ‰çš„è¾¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é‚»æ¥è¡¨ã€‚

$$
Edge =
\begin{matrix}
\quad  & a & b & c & d\\
a & 0  & 1 & 0 & 1\\
b & 1 & 0 &  0 & 0\\
c & 0 & 0 &  0 & 1\\
d & 1 & 0 & 1 & 0\\
\end{matrix}
$$



#### é‚»æ¥è¡¨(list)

$$
\begin{aligned}
&[a] \to  b \to d\\
&[b] \to a\\
&[c  \to d\\
&[d] \to a \to c
\end{aligned}
$$



Code

```cpp
typedef pair<int, int> PII;
vector<vector<PII>> v(n + 1, vector<PII>(0));
    for (int i = 0; i < m; ++i) {
        int a, b, c;
        cin >> a >> b >> c;
        v[a].push_back(PII(b, c)); 
        v[b].push_back(PII(a, c));
    }
    for (int i = 1; i <= n; ++i) {
        cout << i << " : ";
        for (int j = 0; j < v[i].size(); ++j) {
            cout << "(" << v[i][j].first << "," << v[i][j].second << ") ";
        }
        cout << endl;
    }

```



1. é“¾å¼å‰å‘æ˜Ÿ

   ![image-20201027203837070](https://raw.githubusercontent.com/worst0/picture/master/img/image-20201027203837070.png)

   ç”¨æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨ä½¿ç”¨é‚»æ¥è¡¨

```cpp
struct Edge {
    int u, v, w, next;
};
int head[MAX_N + 5], dist[MAX_N + 5];
Edge e[MAX_M + 5];
inline void addEdge(int u, int v, int w) {
    e[++cnt].u = u;
    e[cnt].v = v;
    e[cnt].w = w;
    e[cnt].next = head[u];
    head[u] = cnt;
    return ;
}

```



### å›¾çš„æœç´¢

æŠŠç›¸é‚»é¡¶ç‚¹æŸ“æˆä¸åŒé¢œè‰²çš„é—®é¢˜å«åšå›¾ç€è‰²é—®é¢˜ã€‚å¯¹å›¾è¿›è¡ŒæŸ“è‰²æ‰€éœ€è¦çš„æœ€å°é¢œè‰²æ•°ç§°ä¸ºæœ€å°ç€è‰²æ•°ã€‚æœ€å°ç€è‰²æ•°æ˜¯2çš„å›¾ç§°ä½œäºŒåˆ†å›¾

## æœ€çŸ­è·¯é—®é¢˜



### floyd

foyldç®—æ³•:æ…¢ï¼Œå¤šæºæœ€çŸ­è·¯ï¼Œæ±‚ä»»æ„ä¸¤ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼ŒåŠ¨å½’æ€æƒ³   O(n^3)

>è¿™ä¸ªç®—æ³•çš„ä¸»è¦æ€è·¯ï¼Œå°±æ˜¯é€šè¿‡å…¶ä»–çš„ç‚¹è¿›è¡Œä¸­è½¬æ¥æ±‚çš„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œä¸¤ç‚¹ä¹‹é—´æœ‰å¤šæ¡è·¯ï¼Œå¦‚æœæ¢ä¸€æ¡è·¯å¯ä»¥ç¼©çŸ­è·ç¦»çš„è¯ï¼Œå°±æ›´æ–°æœ€çŸ­è·ç¦»ã€‚è€Œå®ƒæœ€æœ¬è´¨çš„æ€æƒ³ï¼Œå°±æ˜¯ç”¨å…¶ä»–çš„ç‚¹è¿›è¡Œä¸­è½¬ï¼Œä»è€Œè¾¾åˆ°æ±‚å‡ºæœ€çŸ­è·¯çš„ç›®çš„ã€‚
>
>ä¸¤ç‚¹ä¹‹é—´å¯ä»¥ç”±ä¸€ä¸ªç‚¹ä½œä¸ºä¸­è½¬ç‚¹æ›´æ–°æœ€çŸ­è·¯å¾„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤šä¸ªç‚¹æ›´æ–°æœ€çŸ­è·¯å¾„ã€‚

------

```cpp
for(k=1;k<=n;k++)
    for(i=1;i<=n;i++)
        for(j=1;j<=n;j++)
            if(e[i][j]>e[i][k]+e[k][j])
                 e[i][j]=e[i][k]+e[k][j];
```

> æœ€å¼€å§‹åªå…è®¸ç»è¿‡1å·é¡¶ç‚¹è¿›è¡Œä¸­è½¬ï¼Œæ¥ä¸‹æ¥åªå…è®¸ç»è¿‡1å’Œ2å·é¡¶ç‚¹è¿›è¡Œä¸­è½¬â€¦â€¦å…è®¸ç»è¿‡1~nå·æ‰€æœ‰é¡¶ç‚¹è¿›è¡Œä¸­è½¬ï¼Œæ±‚ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯ç¨‹ã€‚ç”¨ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼šä»iå·é¡¶ç‚¹åˆ°jå·é¡¶ç‚¹åªç»è¿‡å‰kå·ç‚¹çš„æœ€çŸ­è·¯ç¨‹



```cpp
int n, m, s, arr[1005][1005];

int main() {
    memset(arr, 0x3F, sizeof(arr));
    cin >> n >> m >> s;
    for (int i = 0; i < m; ++i) {
        int a, b, c;
        cin >> a >> b >> c;
        arr[a][b] = min(arr[a][b], c);
    }
    for (int i = 1; i <= n; ++i) arr[i][i] = 0;
    for (int i = 1; i <= n; ++i) {
        for (int j = 1; j <= n; ++j) {
            for (int k = 1; k <= n; ++k) {
                arr[j][k] = min(arr[j][k], arr[j][i] + arr[i][k]);
            }
        }
    }
    for (int i = 1; i <= n; i++)  {
        i != 1 && cout << " ";
        if (arr[s][i] == 0x3F3F3F3F) {
            cout << -1;
        } else {
            cout << arr[s][i];
        }
    }

    return 0;
}

```



### å•æºæœ€çŸ­è·¯é—®é¢˜  (Bellman-Ford ç®—æ³•ï¼‰

å•æºæœ€çŸ­è·¯é—®é¢˜æ˜¯å›ºå®šä¸€ä¸ªèµ·ç‚¹ï¼Œæ±‚å®ƒåˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯çš„é—®é¢˜ã€‚

è®°ä»èµ·ç‚¹ s å‡ºå‘åˆ°é¡¶ç‚¹ i çš„æœ€çŸ­è·ç¦»ä¸º $d[i]$ã€‚ åˆ™ä¸‹è¿°ç­‰å¼æˆç«‹ã€‚
$d[i] =\min {d[j]+(ä»jåˆ°içš„è¾¹çš„æƒå€¼) \big|e = (j,i) \in Â£}$

å¦‚æœç»™å®šçš„å›¾æ˜¯ä¸€ä¸ª DAG, å°±å¯ä»¥æŒ‰æ‹“æ‰‘åºç»™é¡¶ç‚¹ç¼–å·ï¼Œå¹¶åˆ©ç”¨ç”¨è¿™æ¡é€’æ¨å…³ç³»å¼è®¡ç®—å‡º d

å¦‚æœå›¾ä¸­æœ‰åœˆ ï¼Œå°±æ— æ³•ä¾èµ–è¿™æ ·çš„é¡ºåºè¿›è¡Œè®¡ç®—ã€‚åªè¦å›¾ä¸­ä¸å­˜åœ¨è´Ÿåœˆï¼Œè¿™æ ·çš„æ›´æ–°æ“ä½œå°±æ˜¯æœ‰é™çš„ã€‚

### bellman

bellman-fordç®—æ³•ï¼šå•æºæœ€çŸ­è·¯ O(nm)

> å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œn-1è½®æ¾å¼›æ“ä½œï¼Œå› ä¸ºåœ¨ä¸€ä¸ªå«æœ‰nä¸ªé¡¶ç‚¹çš„å›¾ä¸­ï¼Œä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„æœ€å¤šåŒ…å«n-1è¾¹ã€‚æ¢å¥è¯è¯´ï¼Œç¬¬1è½®åœ¨å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œæ¾å¼›åï¼Œå¾—åˆ°çš„æ˜¯æºç‚¹æœ€å¤šç»è¿‡ä¸€æ¡è¾¹åˆ°è¾¾å…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ï¼›ç¬¬2è½®åœ¨å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œæ¾å¼›åï¼Œå¾—åˆ°çš„æ˜¯æºç‚¹æœ€å¤šç»è¿‡ä¸¤æ¡è¾¹åˆ°è¾¾å…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ï¼›ç¬¬3è½®åœ¨å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œæ¾å¼›åï¼Œå¾—åˆ°çš„æ˜¯æºç‚¹æœ€å¤šç»è¿‡ä¸€æ¡è¾¹åˆ°è¾¾å…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»



```cpp
int n, m, s, edg[50005][3], ans[10005];

int main() {
    memset(ans, 0x3F, sizeof(ans));
    cin >> n >> m >> s;
    for (int i = 0; i < m; ++i) {
        cin >> edg[i][0] >> edg[i][1] >> edg[i][2];
    }
    ans[s] = 0;
    for (int i = 1; i < n; ++i) {
        for (int j = 0; j < m; ++j) {
            ans[edg[j][1]] = min(ans[edg[j][1]], ans[edg[j][0]] + edg[j][2]);
        }
    }
    for (int i = 1; i <= n; ++i) {
        i != 1 && cout << " ";
        if (ans[i] == 0x3F3F3F3F) cout << 0x7fffffff;
        else cout << ans[i];
    }
    cout << endl;
    return 0;
}

```



### dijskstra

dijkstraç®—æ³•ï¼šå•æºæœ€çŸ­è·¯ï¼Œä¸èƒ½æœ‰è´Ÿæƒè¾¹

åœ¨Bellman-Ford ç®—æ³•ä¸­ ï¼Œå¦‚æœ $d[i]$ è¿˜ä¸æ˜¯æœ€çŸ­è·ç¦»çš„è¯ ï¼Œé‚£ä¹ˆå³ä½¿è¿›è¡Œ$d[i] =\min {d[j]+(ä»jåˆ°içš„è¾¹çš„æƒå€¼)}$çš„æ›´æ–°ï¼Œ $d[i]$ ä¹Ÿä¸ä¼šå˜æˆæœ€çŸ­è·ç¦»ã€‚è€Œä¸” å³ä½¿å¤– $d[i]$ æ²¡æœ‰å˜åŒ–ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ä¹Ÿè¦æ£€æŸ»ä¸€éä» i å‡ºå‘çš„æ‰€æœ‰è¾¹ ã€‚è¿™æ˜¾ç„¶æ˜¯å¾ˆæµªè´¹æ—¶é—´çš„ã€‚

å› æ­¤å¯ä»¥å¯¹ç®—æ³•åšå¦‚ä¸‹ä¿®æ”¹ã€‚
(1) æ‰¾åˆ°æœ€çŸ­è·ç¦»å·²ç»ç¡®å®šçš„é¡¶ç‚¹ ï¼Œä»å®ƒå‡ºå‘æ›´æ–°ç›¸é‚»é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚
(2) æ­¤åä¸éœ€è¦å†å…³å¿ƒ1ä¸­ çš„â€œæœ€çŸ­è·ç¦»å·²ç»ç¡®å®šçš„é¡¶ç‚¹â€ã€‚

> **é€šè¿‡â€œè¾¹â€æ¥æ¾å¼›v1é¡¶ç‚¹åˆ°å…¶ä½™å„ä¸ªé¡¶ç‚¹çš„è·¯ç¨‹**ï¼šSæ˜¯å·²è®¡ç®—å‡ºæœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹é›†åˆï¼ŒUæ˜¯æœªè®¡ç®—é™¤æœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹çš„é›†åˆï¼
>
> è´ªå¿ƒ
>
> ç®—æ³•é‡å¤ä»èŠ‚ç‚¹é›†åˆV-Sä¸­é€‰æ‹©æœ€çŸ­è·¯å¾„ä¼°è®¡æœ€å°çš„èŠ‚ç‚¹uï¼Œå°†uåŠ å…¥åˆ°é›†åˆSï¼Œç„¶åå¯¹æ‰€æœ‰ä»uå‡ºå‘çš„è¾¹è¿›è¡Œæ¾å¼›æ“ä½œã€‚
>
> å½“æŠŠä¸€ä¸ªèŠ‚ç‚¹é€‰å…¥é›†åˆSæ—¶ï¼Œå³æ„å‘³ç€å·²ç»æ‰¾åˆ°äº†ä»æºç‚¹åˆ°è¿™ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œä½†è‹¥å­˜åœ¨è´Ÿæƒè¾¹ï¼Œå°±ä¸è¿™ä¸ªå‰æçŸ›ç›¾ï¼Œå¯èƒ½ä¼šå‡ºç°å¾—å‡ºçš„è·ç¦»åŠ ä¸Šè´Ÿæƒåæ¯”å·²ç»å¾—åˆ°Sä¸­çš„æœ€çŸ­è·¯å¾„è¿˜çŸ­

```cpp
#define MAX_N 100000
#define MAX_M 200000
#define INF 0x7fffffff

struct Edge {
    int u, v, w, next;
};

struct Node {
    int now, w;
    bool operator<(const struct Node &b) const {
        return this->w > b.w;
    }
};

int head[MAX_N + 5], dist[MAX_N + 5];
bool vis[MAX_M + 5];
int n, m, s, cnt;
Edge e[MAX_M + 5];
priority_queue<Node> que;

inline void addEdge(int u, int v, int w) {
    e[++cnt].u = u;
    e[cnt].v = v;
    e[cnt].w = w;
    e[cnt].next = head[u];
    head[u] = cnt;
    return ;
}

void dijkstra(){
    memset(dist, 0x3F, sizeof(dist));
    memset(vis, false, sizeof(vis));
    que.push((Node){s, 0});
    dist[s] = 0;
    while (!que.empty()) {
        Node tmp = que.top();
        que.pop();
        int u = tmp.now;
        if (vis[u]) continue;
        vis[u] = true;
        for (int i = head[u]; i != -1; i = e[i].next) {
            int v = e[i].v;
            if (vis[v] == true || dist[v] < dist[u] + e[i].w) continue;
            dist[v] = dist[u] + e[i].w;
            que.push((Node){v, dist[v]});
        }
    }
    return ;
}

int main() {
    memset(head, -1, sizeof(head));
    cin >> n >> m >> s;
    for (int i = 0, a, b, c; i < m; ++i) {
        cin >> a >> b >> c;
        addEdge(a, b, c);
    }
    dijkstra();
    for (int i = 1; i <= n; ++i) {
        i != 1 && cout << " ";
        cout << (dist[i] == 0x3F3F3F3F? INF: dist[i]);
    }
    cout << endl;
    return 0;
}

```

#### 







### spfa(bellmané˜Ÿåˆ—ä¼˜åŒ–)

spfa(bellmané˜Ÿåˆ—ä¼˜åŒ–)ï¼šæœ€åO(nm)

> æ¯æ¬¡ä»…å¯¹æœ€çŸ­è·¯ä¼°è®¡å€¼å‘ç”Ÿå˜åŒ–äº†çš„é¡¶ç‚¹çš„æ‰€æœ‰å‡ºè¾¹æ‰§è¡Œæ¾å¼›æ“ä½œã€‚

è´Ÿç¯ï¼šå¯èƒ½ä¼šä½¿å¾—æƒå€¼è¶Šæ¥è¶Šå°ï¼Œä¸€ç›´èµ°



![image-20201029192331455](https://raw.githubusercontent.com/worst0/picture/master/img/image-20201029192331455.png)

markæ ‡è®°é˜²æ­¢é‡å¤4è¿›å…¥é˜Ÿåˆ—

```cpp
//bellman-é˜Ÿåˆ—ä¼˜åŒ–
//

struct Edge {
    int v, w, next;
};

Edge edg[500005];
int n, m, s, ans[100005], mark[100005], head[100005];

int main() {
    memset(ans, 0x3F, sizeof(ans));
    memset(head, -1, sizeof(head));
    cin >> n >> m >> s;
    for (int i = 0; i < m; ++i) {
        int a, b, c;
        cin >> a >> b >> c;
        edg[i].v = b;
        edg[i].w = c;
        edg[i].next = head[a];
        head[a] = i;
    }
    queue<int> que;
    que.push(s);
    ans[s] = 0;
    while (!que.empty()) {
        int temp = que.front();
        que.pop();
        mark[temp] = 0;
        for (int i = head[temp]; i != -1; i = edg[i].next) {
            int v = edg[i].v, w = edg[i].w;
            if (ans[v] > ans[temp] + w) {
                ans[v] = ans[temp] + w;
                if (mark[v] == 0) {
                    que.push(v);
                    mark[v] = 1;
                }
            }
        }
    }

    for (int i = 1; i <= n; ++i) {
        i != 1 && cout << " ";
        if (ans[i] == 0x3F3F3F3F) cout << 0x7fffffff;
        else cout << ans[i];
    }

    return 0;
}

```

#### è·¯å¾„è¿˜åŸ



## æœ€å°ç”Ÿæˆæ ‘

kruskalï¼šè¯¥ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä»å°åˆ°å¤§åŠ å…¥è¾¹ï¼Œæ˜¯ä¸ªè´ªå¿ƒç®—æ³•ã€‚ç”¨å¹·æŸ¥é›†ç»´æŠ¤ä¸æˆç¯

â€‹	è¾¹æ­£åå­˜

primï¼šä»ä¸€ä¸ªç»“ç‚¹å¼€å§‹ï¼Œä¸æ–­åŠ ç‚¹ï¼ˆè€Œä¸æ˜¯ Kruskal ç®—æ³•çš„åŠ è¾¹ï¼‰ã€‚

å…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡è¦é€‰æ‹©è·ç¦»æœ€å°çš„ä¸€ä¸ªç»“ç‚¹ï¼Œä»¥åŠç”¨æ–°çš„è¾¹æ›´æ–°å…¶ä»–ç»“ç‚¹çš„è·ç¦»ã€‚

éä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘

### prim

```cpp
struct Edge {
    int v, w, next;
};

struct Node {
    int now, val;
    bool operator<(const struct Node &b) const {
        return this->val > b.val;
    }
};

Edge e[400005];
int n, m, ans, edg_cnt, head[5005], already, dist[5005], mark[5005];

inline void addEdge(int u, int v, int w) {
    e[edg_cnt].v = v;
    e[edg_cnt].w = w;
    e[edg_cnt].next = head[u];
    head[u] = edg_cnt++;

}

int main() {
    memset(head, -1, sizeof(head));
    memset(dist, 0x3f, sizeof(dist));
    cin >> n >> m;
    for (int i = 0, u, v, w; i < m; ++i) {
        cin >> u >> v >> w;
        addEdge(u, v, w);
        addEdge(v, u, w);
    }
    priority_queue<Node> que;
    que.push((Node){1, 0});
    while (!que.empty()) {
        Node tmp = que.top();
        que.pop();
        if (mark[tmp.now] == 1) continue;
        mark[tmp.now] = 1;
        ans += tmp.val;
        already++;
        if (already == n) break;
        for (int i = head[tmp.now]; i != -1; i = e[i].next) {
            int v = e[i].v, w = e[i].w;
            if (mark[v] == 0 && dist[v] > w) {
                dist[v] = w;
                que.push((Node){v, w});
            }
        }
    }
    if (already == n) {
        cout << ans << endl;
    } else {
        cout << "orz" << endl;
    }
    return 0;
}

```





### kruskal

```cpp
#define MAX_M 200000
#define MAX_N 5000

struct Edge {
    int u, v, w;
};

bool cmp(const struct Edge &a, const struct Edge &b) {
    return a.w < b.w;
}

Edge e[MAX_M + 5];
int n, m, ans, myUnionSet[MAX_N + 5], already = 1;

int find_root(int x) {
    return myUnionSet[x] = (myUnionSet[x] == x ? x : find_root(myUnionSet[x]));
}

int main() {
    cin >> n >> m;
    for (int i = 0; i < m; ++i) {
        cin >> e[i].u >> e[i].v >> e[i].w; 
    }
    for (int i = 0; i <= n; ++i) {
        myUnionSet[i] = i;
    }
    sort(e, e + m, cmp);
    for (int i = 0; i <= m; ++i) {
        int sr = find_root(e[i].u), er = find_root(e[i].v);
        if (sr != er) {
            already++;
            ans += e[i].w;
            myUnionSet[sr] = er;
            if (already == n) {
                break;
            }
        }
        
    }
    if (already == n) {
        cout << ans << endl;
    } else {
        cout << "orz" << endl;
    }
    return 0;
}

```



## æœ€å°ç”Ÿæˆæ ‘

kruskalï¼šè¯¥ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä»å°åˆ°å¤§åŠ å…¥è¾¹ï¼Œæ˜¯ä¸ªè´ªå¿ƒç®—æ³•ã€‚ç”¨å¹·æŸ¥é›†ç»´æŠ¤ä¸æˆç¯

â€‹	è¾¹æ­£åå­˜

primï¼šä»ä¸€ä¸ªç»“ç‚¹å¼€å§‹ï¼Œä¸æ–­åŠ ç‚¹ï¼ˆè€Œä¸æ˜¯ Kruskal ç®—æ³•çš„åŠ è¾¹ï¼‰ã€‚

å…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡è¦é€‰æ‹©è·ç¦»æœ€å°çš„ä¸€ä¸ªç»“ç‚¹ï¼Œä»¥åŠç”¨æ–°çš„è¾¹æ›´æ–°å…¶ä»–ç»“ç‚¹çš„è·ç¦»ã€‚



éä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘

> ç¨ å¯†å›¾è·‘ Primï¼ 

> ç¨€ç–å›¾è·‘ Kruskalï¼

####  Superbull -æœ€å¤§ç”Ÿæˆæ ‘

> Bessieå’Œå¥¹çš„æœ‹å‹ä»¬æ­£åœ¨ä¸€å¹´ä¸€åº¦çš„Superbullé”¦æ ‡èµ›ä¸­æ‰“çƒï¼Œè€ŒFarmer Johnè´Ÿè´£è®©æ¯”èµ›å°½å¯èƒ½æ¿€åŠ¨äººå¿ƒã€‚æ€»å…±æœ‰ N*N* æ”¯é˜Ÿä¼ï¼ˆ 1â‰¤Nâ‰¤20001â‰¤*N*â‰¤2000 ï¼‰å‚åŠ äº†Superbullé”¦æ ‡èµ›ã€‚æ¯ä¸ªå›¢é˜Ÿéƒ½æœ‰ä¸€ä¸ª 1 ... 2 ^ {30} -11...230âˆ’1çš„å›¢é˜ŸIDã€‚
>
> Superbullæ˜¯ä¸€åœºæ·˜æ±°èµ› - åœ¨æ¯åœºæ¯”èµ›ä¹‹åï¼ŒFJé€‰æ‹©æ·˜æ±°å…¶ä¸­ä¸€æ”¯çƒé˜Ÿï¼Œè€Œè¢«æ·˜æ±°çš„çƒé˜Ÿå†ä¹Ÿæ— æ³•å‚åŠ ä»»ä½•æ¯”èµ›äº†ã€‚å½“åªå‰©ä¸‹ä¸€æ”¯çƒé˜Ÿæ—¶ï¼Œæ¯”èµ›å°±ç»“æŸäº†ã€‚
>
> FJæ³¨æ„åˆ°ä¸€ä¸ªä¸å¯»å¸¸çš„äº‹æƒ…ï¼šåœ¨ä»»ä½•æ¸¸æˆä¸­ï¼Œä¸¤ä¸ªå›¢é˜Ÿçš„æ€»åˆ†æ˜¯ä¸¤ä¸ªå›¢é˜ŸIDçš„æŒ‰ä½å¼‚æˆ–ï¼ˆXORï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç¬¬ 1212 é˜Ÿå’Œç¬¬ 2020 é˜Ÿå°†å‚åŠ æ¯”èµ›ï¼Œåˆ™è¯¥æ¸¸æˆçš„å¾—åˆ†ä¸º 2424 åˆ†ï¼Œå› ä¸º01100 XOR 10100 = 11000ã€‚
>
> FJæƒ³è¦è®¾è®¡ä¸€ç§æ¯”èµ›æ–¹æ¡ˆï¼Œè®©æ‰€æœ‰æ¯”èµ›çš„å¾—åˆ†æ€»å’Œæœ€å¤§ã€‚è¯·å¸®åŠ©Farmer Johnç»„ç»‡æ¯”èµ›ã€‚
>
> è¾“å…¥æ ¼å¼ï¼šç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ•´æ•° N*N* ï¼Œä¸‹é¢ N*N* è¡Œæ¯è¡ŒåŒ…æ‹¬ä¸€ä¸ªé˜Ÿä¼çš„IDã€‚
>
> è¾“å‡ºæ ¼å¼ï¼šè¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ¯”èµ›çš„æœ€å¤§æ€»å¾—åˆ†ã€‚
>
> æ ·ä¾‹è§£é‡Šï¼šè®© 33 é˜Ÿä¸ 99 é˜Ÿè¿›è¡Œæ¯”èµ›ï¼Œå¹¶è®© 99 é˜Ÿæ™‹çº§ã€‚ç„¶åä»–è®© 66 é˜Ÿå’Œ 99 é˜Ÿå¯¹å†³ï¼Œè®© 66 é˜Ÿè·èƒœã€‚æœ€åï¼Œç¬¬ 66 é˜Ÿå’Œç¬¬ 1010 é˜Ÿæ¯”èµ›ï¼Œ 1010 é˜Ÿè·èƒœã€‚æ€»å¾—åˆ†ä¸ºï¼š3 XOR 9+6 XOR 9+6 XOR 10=10+15+12=37ã€‚



ä¸¤ç‚¹çš„äº¦æˆ–å°±æ˜¯è¾¹å€¼ï¼Œä¸¤ä¸ªç‚¹åˆå¹¶ä¸€æ¬¡å˜ä¸€ä¸ªç‚¹ï¼ˆä¸¤ä¸ªé˜Ÿæ¯”èµ›å‰©ä¸€é˜Ÿï¼‰



#### P4047éƒ¨è½åˆ’åˆ†

> èªèªç ”ç©¶å‘ç°ï¼Œè’å²›é‡äººæ€»æ˜¯è¿‡ç€ç¾¤å±…çš„ç”Ÿæ´»ï¼Œä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯æ•´ä¸ªè’å²›ä¸Šçš„æ‰€æœ‰é‡äººéƒ½å±äºåŒä¸€ä¸ªéƒ¨è½ï¼Œé‡äººä»¬æ€»æ˜¯æ‹‰å¸®ç»“æ´¾å½¢æˆå±äºè‡ªå·±çš„éƒ¨è½ï¼Œä¸åŒçš„éƒ¨è½ä¹‹é—´åˆ™ç»å¸¸å‘ç”Ÿäº‰æ–—ã€‚åªæ˜¯ï¼Œè¿™ä¸€åˆ‡éƒ½æˆä¸ºè°œå›¢äº†â€”â€”èªèªæ ¹æœ¬å°±ä¸çŸ¥é“éƒ¨è½ç©¶ç«Ÿæ˜¯å¦‚ä½•åˆ†å¸ƒçš„ã€‚
>
> ä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼Œèªèªå¾—åˆ°äº†ä¸€ä»½è’å²›çš„åœ°å›¾ã€‚åœ°å›¾ä¸Šæ ‡æ³¨äº† n*n* ä¸ªé‡äººå±…ä½çš„åœ°ç‚¹ï¼ˆå¯ä»¥çœ‹ä½œæ˜¯å¹³é¢ä¸Šçš„åæ ‡ï¼‰ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒåŒä¸€ä¸ªéƒ¨è½çš„é‡äººæ€»æ˜¯ç”Ÿæ´»åœ¨é™„è¿‘ã€‚æˆ‘ä»¬æŠŠä¸¤ä¸ªéƒ¨è½çš„è·ç¦»ï¼Œå®šä¹‰ä¸ºéƒ¨è½ä¸­è·ç¦»æœ€è¿‘çš„é‚£ä¸¤ä¸ªå±…ä½ç‚¹çš„è·ç¦»ã€‚èªèªè¿˜è·å¾—äº†ä¸€ä¸ªæœ‰æ„ä¹‰çš„ä¿¡æ¯â€”â€”è¿™äº›é‡äººæ€»å…±è¢«åˆ†ä¸ºäº† k*k* ä¸ªéƒ¨è½ï¼è¿™çœŸæ˜¯ä¸ªå¥½æ¶ˆæ¯ã€‚èªèªå¸Œæœ›ä»è¿™äº›ä¿¡æ¯é‡ŒæŒ–æ˜å‡ºæ‰€æœ‰éƒ¨è½çš„è¯¦ç»†ä¿¡æ¯ã€‚ä»–æ­£åœ¨å°è¯•è¿™æ ·ä¸€ç§ç®—æ³•ï¼š
>
> å¯¹äºä»»æ„ä¸€ç§éƒ¨è½åˆ’åˆ†çš„æ–¹æ³•ï¼Œéƒ½èƒ½å¤Ÿæ±‚å‡ºä¸¤ä¸ªéƒ¨è½ä¹‹é—´çš„è·ç¦»ï¼Œèªèªå¸Œæœ›æ±‚å‡ºä¸€ç§éƒ¨è½åˆ’åˆ†çš„æ–¹æ³•ï¼Œä½¿é å¾—æœ€è¿‘çš„ä¸¤ä¸ªéƒ¨è½å°½å¯èƒ½è¿œç¦»ã€‚
>
> ä¾‹å¦‚ï¼Œä¸‹é¢çš„å·¦å›¾è¡¨ç¤ºäº†ä¸€ä¸ªå¥½çš„åˆ’åˆ†ï¼Œè€Œå³å›¾åˆ™ä¸æ˜¯ã€‚è¯·ä½ ç¼–ç¨‹å¸®åŠ©èªèªè§£å†³è¿™ä¸ªéš¾é¢˜ã€‚

![img](/Image/A14.å›¾è®º-photo/30573.png)

é€‰n-kæ¡è¾¹åˆ’åˆ†çœ‹ä¸ªéƒ¨è½ï¼Œæ‰¾ä¸åœ¨åŒä¸€éƒ¨è½çš„æœ€å°è¾¹





#### luogu-P1119 ç¾åé‡å»º



> ç»™å‡ºB*B*åœ°åŒºçš„æ‘åº„æ•°N*N*ï¼Œæ‘åº„ç¼–å·ä»00åˆ°N-1*N*âˆ’1ï¼Œå’Œæ‰€æœ‰M*M*æ¡å…¬è·¯çš„é•¿åº¦ï¼Œå…¬è·¯æ˜¯åŒå‘çš„ã€‚å¹¶ç»™å‡ºç¬¬i*i*ä¸ªæ‘åº„é‡å»ºå®Œæˆçš„æ—¶é—´t_i*t**i*ï¼Œä½ å¯ä»¥è®¤ä¸ºæ˜¯åŒæ—¶å¼€å§‹é‡å»ºå¹¶åœ¨ç¬¬t_i*t**i*å¤©é‡å»ºå®Œæˆï¼Œå¹¶ä¸”åœ¨å½“å¤©å³å¯é€šè½¦ã€‚è‹¥t_i*t**i*ä¸º00åˆ™è¯´æ˜åœ°éœ‡æœªå¯¹æ­¤åœ°åŒºé€ æˆæŸåï¼Œä¸€å¼€å§‹å°±å¯ä»¥é€šè½¦ã€‚ä¹‹åæœ‰Q*Q*ä¸ªè¯¢é—®(x, y, t)(*x*,*y*,*t*)ï¼Œå¯¹äºæ¯ä¸ªè¯¢é—®ä½ è¦å›ç­”åœ¨ç¬¬t*t*å¤©ï¼Œä»æ‘åº„x*x*åˆ°æ‘åº„yçš„æœ€çŸ­è·¯å¾„é•¿åº¦ä¸ºå¤šå°‘ã€‚å¦‚æœæ— æ³•æ‰¾åˆ°ä»x*x*æ‘åº„åˆ°y*y*æ‘åº„çš„è·¯å¾„ï¼Œç»è¿‡è‹¥å¹²ä¸ªå·²é‡å»ºå®Œæˆçš„æ‘åº„ï¼Œæˆ–è€…æ‘åº„x*x*æˆ–æ‘åº„y*y*åœ¨ç¬¬tå¤©ä»æœªé‡å»ºå®Œæˆ ï¼Œåˆ™éœ€è¦è¿”å›-1âˆ’1ã€‚

é¦–å…ˆè°ˆè°ˆFloyedç®—æ³•ï¼šFloydç®—æ³•çš„æœ¬è´¨æ˜¯åŠ¨æ€è§„åˆ’ï¼Œå…¶è½¬ç§»æ–¹ç¨‹ ä¸ºï¼šf[k][i][j] = min( f[k-1][i][j], f([k-1][i] [k])+f[k-1][k][j] )ã€‚

f[k][i][j]è¡¨ç¤ºè·¯å¾„é™¤å¼€èµ·ç‚¹iä¸ç»ˆç‚¹jï¼Œåªç»è¿‡å‰kä¸ªç‚¹ä¸­çš„æŸäº› ç‚¹ï¼Œä»iåˆ°jçš„æœ€å°å€¼ã€‚è®¡ç®—è¿™ä¸ªå€¼åªéœ€è¦è€ƒè™‘ä¸¤ç§æƒ…å†µï¼šæœ€çŸ­è·¯ç» è¿‡kï¼Œå’Œæœ€çŸ­è·¯ä¸ç»è¿‡kï¼ˆé‚£ä¹ˆå°±ç»è¿‡å‰k-1ä¸ªç‚¹ä¸­çš„æŸäº›ç‚¹ï¼‰ã€‚ç”±äº kè¦ä»k-1è½¬ç§»è€Œæ¥ï¼Œè‡ªç„¶kä¸ºæœ€å¤–å±‚çš„å¾ªç¯ã€‚è€Œç»è¿‡æ»šåŠ¨ï¼ˆç±»ä¼¼äºèƒŒ åŒ…é—®é¢˜ï¼‰åï¼Œå°±å˜æˆäº†æˆ‘ä»¬ç†Ÿæ‚‰çš„f[i][j]=min(f[i][j],f[i] [k]+f[k][j])äº†ã€‚

ä½¿ç”¨å‰iä¸ªç‚¹è¿›è¡Œæ›´æ–°

```cpp
#define MAX_N 200
#define MAX_M 20000
int n, m, q;
int matrix[MAX_N + 5][MAX_N + 5];
int t[MAX_N + 5];

inline void update(int k) {
    for (int i = 0; i < n; ++i) {
        for (int j = 0; j < n; ++j) {
            matrix[i][j] = min(matrix[i][j], matrix[i][k] + matrix[k][j]);
        }
    }
    return ;
}

int main() {
    memset(matrix, 0x3f, sizeof(matrix));
    scanf("%d%d", &n, &m);
    for (int i = 0; i < n; ++i) {
        scanf("%d", t + i);
        matrix[i][i] = 0;
    }
    for (int i = 0, a, b, c; i < m; ++i) {
        scanf("%d%d%d", &a, &b, &c);
        matrix[a][b] = c;
        matrix[b][a] = c;
    }
    scanf("%d", &q);
    int now = 0;
    for (int i = 0, a, b, c; i < q; ++i) {
        scanf("%d%d%d", &a, &b, &c);
        while (t[now] <= c && now < n) update(now), now++;
        if (t[a] > c || t[b] > c) printf("-1\n");
        else if (matrix[a][b] == 0x3f3f3f3f) printf("-1\n");
        else printf("%d\n",matrix[a][b]);
    }
    return 0;
}

```



####  luogu-P1340 å…½å¾„ç®¡ç†

> é€†åºè·‘kruskal
>
> è¿™æ ·çš„å¥½å¤„åœ¨äºï¼Œä¸€æ—¦å‘ç°æŸä¸€å‘¨ä¸èƒ½æ„æˆæœ€å°ç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆé‚£å‘¨ä¹‹å‰ä¹Ÿä¸å¯èƒ½æ„æˆæœ€å°ç”Ÿæˆæ ‘ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°‘è·‘å¾ˆå¤šæ¬¡kruskal
>
> å› ä¸ºåªèƒ½ç”¨é‚£ä¸€å‘¨åŠä¹‹å‰çš„å…½å¾„å»ºæ ‘ï¼Œè€Œåœ¨å¿«æ’çš„æ—¶å€™è¾¹ä¼šè¢«æ‰“ä¹±ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç»“æ„ä½“å­˜è¾¹æ—¶è¦åŠ ä¸€ä¸ªå‚æ•°ï¼Œè®°å½•è¯¥è¾¹æ˜¯ç¬¬å‡ å‘¨çš„å…½å¾„

```cpp
int prime(int time) {
    uset.init(n);
    memset(mask, false, sizeof(mask));
    int alreaday = 1;
    int ans = 0;
    for (int i = 0; i < m; i++) {
        if (e[i].t > time)  continue;
        int u = e[i].u, v = e[i].v, w = e[i].w;
        if (uset.get(u) == uset.get(v)) continue;
        mask[e[i].t] = true;
        uset.merge(u, v);
        alreaday++;
        ans += w;
        if (alreaday == n)  break;
    }
    return alreaday == n ? ans : -1;
}

int main() {
    cin >> n >> m;
    for (int i = 0; i < m; i++) {
        cin >> e[i].u >> e[i].v >> e[i].w;
        e[i].t = i;
    }

    sort(e, e + m, [](const Edge &a, const Edge &b) {
        return a.w < b.w;
    });
    int last = prime(m - 1); 
    vector<int> ans(m);
    ans[m - 1] = last;
    for (int i = m - 2; i >= 0; i--) {
        if (last == -1) {
            ans[i] = -1;
            continue;
        }
        if (mask[i + 1] == true) {
            last = prime(i);
        }
        ans[i] = last;
    }

    for (int i = 0; i < m; i++)  {
        cout << ans[i] << endl;
    }
    return 0;
}
```



#### luogu-P1629 é‚®é€’å‘˜é€ä¿¡

æ­£ç€èµ°è¿‡å»çš„æ—¶å€™ç”¨ä¸€ä¾¿dijkstraã€‚
è¿”å›æ—¶å°±å»ºä¸ªè¿”å›¾è·‘ä¸€édijkstraã€‚

> æœ‰ä¸€ä¸ªé‚®é€’å‘˜è¦é€ä¸œè¥¿ï¼Œé‚®å±€åœ¨èŠ‚ç‚¹ 11ã€‚ä»–æ€»å…±è¦é€ n-1*n*âˆ’1 æ ·ä¸œè¥¿ï¼Œå…¶ç›®çš„åœ°åˆ†åˆ«æ˜¯èŠ‚ç‚¹ 22 åˆ°èŠ‚ç‚¹ n*n*ã€‚ç”±äºè¿™ä¸ªåŸå¸‚çš„äº¤é€šæ¯”è¾ƒç¹å¿™ï¼Œå› æ­¤æ‰€æœ‰çš„é“è·¯éƒ½æ˜¯å•è¡Œçš„ï¼Œå…±æœ‰ m*m* æ¡é“è·¯ã€‚è¿™ä¸ªé‚®é€’å‘˜æ¯æ¬¡åªèƒ½å¸¦ä¸€æ ·ä¸œè¥¿ï¼Œå¹¶ä¸”**è¿é€æ¯ä»¶ç‰©å“è¿‡åå¿…é¡»è¿”å›é‚®å±€**ã€‚æ±‚é€å®Œè¿™ n-1*n*âˆ’1 æ ·ä¸œè¥¿å¹¶ä¸”**æœ€ç»ˆå›åˆ°é‚®å±€**æœ€å°‘éœ€è¦çš„æ—¶é—´ã€‚



#### P1144 æœ€çŸ­è·¯è®¡æ•°

ç»™å‡ºä¸€ä¸ªN*N*ä¸ªé¡¶ç‚¹M*M*æ¡è¾¹çš„æ— å‘æ— æƒå›¾ï¼Œé¡¶ç‚¹ç¼–å·ä¸º1-N1âˆ’*N*ã€‚é—®ä»é¡¶ç‚¹11å¼€å§‹ï¼Œåˆ°å…¶ä»–æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æœ‰å‡ æ¡ã€‚

è¯·æ³¨æ„å¯èƒ½æœ‰è‡ªç¯ä¸é‡è¾¹ã€‚

```cpp
void dijskstra(int start) {
    memset(visit, false, sizeof(visit));
    priority_queue<Node> que;
    que.push({start, 0});
    dist[start] = 0;
    ans[start] = 1;
    while (!que.empty()) {
        Node cur = que.top();
        que.pop();
        int now = cur.now;
        if (visit[now]) continue;
        visit[now] = true;
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v;
            if (visit[v] || dist[v] < cur.w + 1) continue;
            if (dist[v] == cur.w + 1) {
                ans[v] += ans[now];
            }
            else {
                dist[v] = cur.w + 1;
                ans[v] = ans[now];
                que.push({v, dist[v]});
            }
            ans[v] %= MOD;
        }
    }
}

```

#### P2865 [USACO06NOV]Roadblocks G

> è´èŒœæŠŠå®¶æ¬åˆ°äº†ä¸€ä¸ªå°å†œåœºï¼Œä½†å¥¹å¸¸å¸¸å›åˆ°FJçš„å†œåœºå»æ‹œè®¿å¥¹çš„æœ‹å‹ã€‚è´èŒœå¾ˆå–œæ¬¢è·¯è¾¹çš„é£æ™¯ï¼Œä¸æƒ³é‚£ä¹ˆå¿«åœ°ç»“æŸå¥¹çš„æ—…é€”ï¼Œäºæ˜¯å¥¹æ¯æ¬¡å›å†œåœºï¼Œéƒ½ä¼šé€‰æ‹©ç¬¬äºŒçŸ­çš„è·¯å¾„ï¼Œè€Œä¸è±¡æˆ‘ä»¬æ‰€ä¹ æƒ¯çš„é‚£æ ·ï¼Œé€‰æ‹©æœ€çŸ­è·¯ã€‚ è´èŒœæ‰€åœ¨çš„ä¹¡æ‘æœ‰R(1<=R<=100,000)æ¡åŒå‘é“è·¯ï¼Œæ¯æ¡è·¯éƒ½è”ç»“äº†æ‰€æœ‰çš„N(1<=N<=5000)ä¸ªå†œåœºä¸­çš„æŸä¸¤ä¸ªã€‚è´èŒœå±…ä½åœ¨å†œåœº1ï¼Œå¥¹çš„æœ‹å‹ä»¬å±…ä½åœ¨å†œåœºNï¼ˆå³è´èŒœæ¯æ¬¡æ—…è¡Œçš„ç›®çš„åœ°ï¼‰ã€‚ è´èŒœé€‰æ‹©çš„ç¬¬äºŒçŸ­çš„è·¯å¾„ä¸­ï¼Œå¯ä»¥åŒ…å«ä»»ä½•ä¸€æ¡åœ¨æœ€çŸ­è·¯ä¸­å‡ºç°çš„é“è·¯ï¼Œå¹¶ä¸”ï¼Œä¸€æ¡è·¯å¯ä»¥é‡å¤èµ°å¤šæ¬¡ã€‚å½“ç„¶å’¯ï¼Œç¬¬äºŒçŸ­è·¯çš„é•¿åº¦å¿…é¡»ä¸¥æ ¼å¤§äºæœ€çŸ­è·¯ï¼ˆå¯èƒ½æœ‰å¤šæ¡ï¼‰çš„é•¿åº¦ï¼Œä½†å®ƒçš„é•¿åº¦å¿…é¡»ä¸å¤§äºæ‰€æœ‰é™¤æœ€çŸ­è·¯å¤–çš„è·¯å¾„çš„é•¿åº¦ã€‚



```cpp
void bellman(int start, int k) {
    memset(visit, false, sizeof(visit));
    queue<int> que;
    que.push(start);
    dist[k][start] = 0;
    visit[start] = true;
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        visit[now] = false;
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v, w = e[i].w;
            if (dist[k][v] > dist[k][now] + w) {
                dist[k][v] = dist[k][now] + w;
                if (visit[v] == false) {
                    visit[v] = true;
                    que.push(v);
                }
            }
        }
    }
    return ;
}

int main() {
    init();
    cin >> n >> m;
    for (int i = 0, u, v, w; i < m; i++) {
        cin >> u >> v >> w;
        addEdge(u, v, w);
        addEdge(v, u, w);
    }
    bellman(1, 0);
    bellman(n, 1);
    int ans = 0x3f3f3f3f;
    for (int i = 0; i < cnt; i++) {
        int val = dist[0][e[i].u] + dist[1][e[i].v] + e[i].w;
        if (val != dist[0][n] && val < ans) {
            ans = val;
        }
    }
    cout << ans << endl;
    return 0;
}

```





```cpp
void bellman(int start) {
    memset(visit, false, sizeof(visit));
    queue<int> que;
    dist[0][start] = 0;
    que.push(start);
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        visit[now] = false;
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v, w = e[i].w;
            int val = dist[0][now] + w;
            if (dist[0][v] > val) { //ç”¨æœ€çŸ­è·¯æ›´æ–°æœ€çŸ­è·¯
                dist[1][v] = dist[0][v];
                dist[0][v] = val;
                if (visit[v] == false) {
                    visit[v] = true;
                    que.push(v);
                }
            }
            if (dist[0][v] < val && dist[1][v] > val) { //ç”¨æœ€çŸ­è·¯æ›´æ–°æ¬¡çŸ­è·¯
                dist[1][v] = val;
                if (visit[v] == false) {
                    visit[v] = true;
                    que.push(v);
                }
            }
            if (dist[1][v] > dist[1][now] + w) { //ç”¨æ¬¡çŸ­è·¯æ›´æ–°æ¬¡çŸ­è·¯
                dist[1][v] = dist[1][now] + w; 
                if (visit[v] == false) {
                    visit[v] = true;
                    que.push(v);
                }
            }
        }
    }
}

```





#### hzoj-639. è½¦ç«™åˆ†çº§

ä»¬å¯ä»¥çŸ¥é“ä¸€è¾†è½¦æ²¡ç»è¿‡çš„ç«™ï¼Œä¸€å®šæ¯”ç»è¿‡çš„ç«™çº§åˆ«ä½ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå»ºè¾¹ï¼Œç„¶åbfsä¸€ä¸‹ï¼Œ



####  cd-109-1.çº¦ç‘Ÿå¤«ç¯

ç»å…¸çº¦ç‘Ÿå¤«é—®é¢˜ï¼Œæœ‰nä¸ªäººï¼Œæ¯æ¬¡æ•°åˆ°ç¬¬kä¸ªäººå‡ºåˆ—ï¼Œæ±‚å‰©ä¸‹çš„æœ€åä¸€äººã€‚

```cpp
#include <iostream>
using namespace std;
  
int main()
{
    int n, m, s, oldn=1, newn=1;
    cin>>n>>m;
      
    for(int i = 1;i<n;i++){
        newn = oldn;
        s = (m-1)%(i+1)+1;
        oldn = newn <= i+1-s? s+newn: newn+s-1-i;
    }
    cout<<oldn<<endl;
    return 0;
}

int main() {
    int n, m;
    cin >> n >> m;
    int res = 0;
    for (int i = 2; i <= n; ++i) res = (res + m) % i;
    cout << res + 1 << endl;
    return 0;
}

```





åˆ†æï¼šç”¨çº¿æ®µæ ‘æ¨¡æ‹Ÿçº¦ç‘Ÿå¤«é—®é¢˜ï¼Œè®°å½•åŒºé—´çš„å‡å°‘æƒ…å†µï¼Œç„¶åæ ¹æ®æ¯æ¬¡æ•°åˆ°çš„äººåœ¨åŒºé—´æ’ç¬¬å‡ ä½ï¼Œçº¿æ®µæ ‘log(n)æ‰¾åˆ°å¹¶æ›´æ–°ï¼Œæ€»å¤æ‚åº¦ä¸ºO(nlog(n))ã€‚

```cpp
#include <cstdio>
#include <cstring>
#include <cmath>
#include <algorithm>
#define N 100010
#define mod 1000000007
#define LL long long
#define lson l,m,rt<<1
#define rson m+1,r,rt<<1|1
using namespace std;
int n,k;
int sum[N<<2],vis[N];
void Pushup(int rt)
{
    int ls=rt<<1,rs=ls|1;
    sum[rt]=sum[ls]+sum[rs];
}
void build(int l,int r,int rt)
{
    if(l==r)
    {
        sum[rt]=1;return;
    }
    int m=(l+r)>>1;
    build(lson);
    build(rson);
    Pushup(rt);
}
void update(int num,int l,int r,int rt)
{
    if(l==r)
    {
        vis[l]=1;
        sum[rt]=0;
        return;
    }
    int m=(l+r)>>1;
    if(num<=sum[rt<<1])update(num,lson);
    else update(num-sum[rt<<1],rson);
    Pushup(rt);
}
int main()
{
    int T,cas=1;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%d%d",&n,&k);
        memset(vis,0,sizeof(vis));
        build(1,n,1);
        int num=1;
        for(int i=n;i>1;i--)
        {
            num=(num+k-1)%i;
            if(num==0)num=i;
            update(num,1,n,1);
        }
        for(int i=1;i<=n;i++)
        if(!vis[i])
        {
            printf("Case %d: %d\n",cas++,i);break;
        }
    }
}
```

# ==æ‹“æ‰‘æ’åº==

#### HZOJ-ç¥ç»ç½‘ç»œ



> åœ¨å…°å…°çš„æ¨¡å‹ä¸­ï¼Œç¥ç»ç½‘ç»œå°±æ˜¯ä¸€å¼ æœ‰å‘å›¾ï¼Œå›¾ä¸­çš„èŠ‚ç‚¹ç§°ä¸ºç¥ç»å…ƒï¼Œè€Œä¸”ä¸¤ä¸ªç¥ç»å…ƒä¹‹é—´è‡³å¤šæœ‰ä¸€æ¡è¾¹ç›¸è¿ï¼Œå¦‚æœæœ‰ä¸€æ¡è¾¹ *ğ‘‹*X çš„ç»ˆç‚¹æ˜¯ç¬¬ *ğ‘–*i å·ç¥ç»å…ƒï¼Œé‚£ä¹ˆ *ğ‘‹*X å³ä¸ºè¯¥ç¥ç»å…ƒçš„è¾“å…¥é€šé“ï¼Œå¦‚æœæœ‰ä¸€æ¡è¾¹ *ğ‘Œ*Y çš„èµ·ç‚¹æ˜¯ç¬¬ *ğ‘–*i å·ç¥ç»å…ƒï¼Œé‚£ä¹ˆ *ğ‘Œ*Y å³ä¸ºè¯¥ç¥ç»å…ƒçš„è¾“å‡ºé€šé“ï¼Œ*ğ¶**ğ‘–*Ci è¡¨ç¤ºç¥ç»å…ƒç›®å‰çš„çŠ¶æ€ï¼Œ*ğ‘ˆ**ğ‘–*Ui æ˜¯é˜ˆå€¼ï¼Œå¯è§†ä¸ºç¥ç»å…ƒçš„ä¸€ä¸ªå†…åœ¨å‚æ•°ã€‚
>
> ç¥ç»å…ƒæŒ‰ä¸€å®šçš„é¡ºåºæ’åˆ—ï¼Œæ„æˆæ•´ä¸ªç¥ç»ç½‘ç»œã€‚åœ¨å…°å…°çš„æ¨¡å‹ä¹‹ä¸­ï¼Œç¥ç»ç½‘ç»œä¸­çš„ç¥ç»å…ƒåˆ†ä¸ºå‡ å±‚ï¼›ç§°ä¸ºè¾“å…¥å±‚ã€è¾“å‡ºå±‚ï¼Œå’Œè‹¥å¹²ä¸ªä¸­é—´å±‚ã€‚æ¯å±‚ç¥ç»å…ƒåªå‘ä¸‹ä¸€å±‚çš„ç¥ç»å…ƒè¾“å‡ºä¿¡æ¯ï¼Œåªä»ä¸Šä¸€å±‚ç¥ç»å…ƒæ¥å—ä¿¡æ¯ã€‚
>
> å…°å…°è§„å®šï¼Œ*ğ¶**ğ‘–*Ci æœä»å…¬å¼ï¼š
>
> *ğ¶**ğ‘–*=âˆ‘*ğ‘Š**ğ‘—**ğ‘–**ğ¶**ğ‘—*âˆ’*ğ‘ˆ**ğ‘–*  ((*ğ‘—*,*ğ‘–*)âˆˆ*ğ¸*)Ci=âˆ‘WjiCjâˆ’Ui  ((j,i)âˆˆE)
>
> å…¬å¼ä¸­çš„ *ğ‘Š**ğ‘—**ğ‘–*Wjiï¼ˆå¯èƒ½ä¸ºè´Ÿå€¼ï¼‰è¡¨ç¤ºè¿æ¥ *ğ‘—*j å·ç¥ç»å…ƒå’Œ *ğ‘–*i å·ç¥ç»å…ƒçš„è¾¹çš„æƒå€¼ã€‚å½“ *ğ¶**ğ‘–*Ci å¤§äº 00 æ—¶ï¼Œè¯¥ç¥ç»å…ƒå¤„äºå…´å¥‹çŠ¶æ€ï¼Œå¦åˆ™å°±å¤„äºå¹³é™çŠ¶æ€ã€‚å½“ç¥ç»å…ƒå¤„äºå…´å¥‹çŠ¶æ€æ—¶ï¼Œä¸‹ä¸€ç§’å®ƒä¼šå‘å…¶ä»–ç¥ç»å…ƒä¼ é€ä¿¡å·ï¼Œä¿¡å·çš„å¼ºåº¦ä¸º*ğ¶**ğ‘–*Ciã€‚
>
> å¦‚æ­¤ï¼Œåœ¨è¾“å…¥å±‚ç¥ç»å…ƒè¢«æ¿€å‘ä¹‹åï¼Œæ•´ä¸ªç½‘ç»œç³»ç»Ÿå°±åœ¨ä¿¡æ¯ä¼ è¾“çš„æ¨åŠ¨ä¸‹è¿›è¡Œè¿ä½œã€‚ç°åœ¨ï¼Œç»™å®šä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŠå½“å‰è¾“å…¥å±‚ç¥ç»å…ƒçš„çŠ¶æ€ï¼ˆ*ğ¶**ğ‘–*Ciï¼‰ï¼Œè¦æ±‚ä½ çš„ç¨‹åºè¿ç®—å‡ºæœ€åç½‘ç»œè¾“å‡ºå±‚çš„çŠ¶æ€ã€‚

------

```cpp
int head[MAX_N + 5], in_degree[MAX_N + 5], out_degree[MAX_N + 5];
int c[MAX_N + 5], u[MAX_N + 5];

int main() {
    memset(head, -1, sizeof(head));
    cin >> n >> p;
    queue<int> que;
    for (int i = 1; i <= n; i++) {
        cin >> c[i] >> u[i];
        if (c[i]) que.push(i);
    }
    for (int i = 1, x, y, z; i <= p; i++) {
        cin >> x >> y >> z;
        e[i].v = y;
        e[i].w = z;
        e[i].next = head[x];
        head[x] = i;
        in_degree[y]++;
        out_degree[x]++;
    }
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v, w = e[i].w;
            if (c[now] > 0) {
                c[v] += c[now] * w;
            }
            in_degree[v]--;
            if (in_degree[v] == 0) {
                que.push(v);
                c[v] -= u[v];
            }
        }
    }
    
    int flag = 0;
    for (int i = 1; i <= n; i++) {
        if (out_degree[i] || c[i] <= 0) continue;
        cout << i << " " << c[i] << endl;
        flag = 1;
    }
    if (!flag) cout << "NULL" << endl;
    return 0;
}

```





####  HZOJ-æ—…è¡Œè®¡åˆ’

>  å°æ˜è¦å»ä¸€ä¸ªå›½å®¶æ—…æ¸¸ã€‚è¿™ä¸ªå›½å®¶æœ‰ *ğ‘*N ä¸ªåŸå¸‚ï¼Œç¼–å·ä¸º 11 è‡³ *ğ‘*Nï¼Œå¹¶ä¸”æœ‰ *ğ‘€*M æ¡é“è·¯è¿æ¥ç€ï¼Œå°æ˜å‡†å¤‡ä»å…¶ä¸­ä¸€ä¸ªåŸå¸‚å‡ºå‘ï¼Œå¹¶åªå¾€ä¸œèµ°åˆ°åŸå¸‚ *ğ‘–*i åœæ­¢ã€‚
>
>  æ‰€ä»¥ä»–å°±éœ€è¦é€‰æ‹©æœ€å…ˆåˆ°è¾¾çš„åŸå¸‚ï¼Œå¹¶åˆ¶å®šä¸€æ¡è·¯çº¿ä»¥åŸå¸‚ *ğ‘–*i ä¸ºç»ˆç‚¹ï¼Œä½¿å¾—çº¿è·¯ä¸Šé™¤äº†ç¬¬ä¸€ä¸ªåŸå¸‚ï¼Œæ¯ä¸ªåŸå¸‚éƒ½åœ¨è·¯çº¿å‰ä¸€ä¸ªåŸå¸‚ä¸œé¢ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªå‰æä¸‹è¿˜å¸Œæœ›æ¸¸è§ˆçš„åŸå¸‚å°½é‡å¤šã€‚
>
>  ç°åœ¨ï¼Œä½ åªçŸ¥é“æ¯ä¸€æ¡é“è·¯æ‰€è¿æ¥çš„ä¸¤ä¸ªåŸå¸‚çš„ç›¸å¯¹ä½ç½®å…³ç³»ï¼Œä½†å¹¶ä¸çŸ¥é“æ‰€æœ‰åŸå¸‚å…·ä½“çš„ä½ç½®ã€‚ç°åœ¨å¯¹äºæ‰€æœ‰çš„ *ğ‘–*iï¼Œéƒ½éœ€è¦ä½ ä¸ºå°æ˜åˆ¶å®šä¸€æ¡è·¯çº¿ï¼Œå¹¶æ±‚å‡ºä»¥åŸå¸‚ *ğ‘–*i ä¸ºç»ˆç‚¹æœ€å¤šèƒ½å¤Ÿæ¸¸è§ˆå¤šå°‘ä¸ªåŸå¸‚ã€‚

æ‹“æ‰‘æ’åºï¼Œæ›´æ–°ä¸‹ä¸€èŠ‚ç‚¹çš„å€¼



#### HZOJ-å®¿èˆæ¥¼é‡Œçš„ç”µç«èµ›

>  å¤§ *ğ‘‡*T æ‰€åœ¨çš„å¤§å­¦å®¿èˆæ¥¼ä¸€ç›´ä»¥æ¥æœ‰ç€ä¸¾åŠç”µç«æ¯”èµ›çš„ä¼˜è‰¯ä¼ ç»Ÿâ‘ â‘  ï¼ˆ*ğ‘Š**ğ´**ğ‘…*3ï¼Œ*ğ¶**ğ‘†*1.6WAR3ï¼ŒCS1.6 ç­‰ï¼‰ï¼Œç°åœ¨æƒ³çŸ¥é“æŸä¸€å¹´çš„å†å²æ’åï¼Œä½†æ˜¯è®°å½•æ¯”èµ›æ’åçš„çº¸å·²ç»è¢«æ±¡æŸäº†ï¼Œåªæœ‰ä¸€éƒ¨åˆ†æ¯”èµ›è¿‡ç¨‹è¢«ä¿ç•™äº†ä¸‹æ¥ï¼Œç°éœ€è¦é€šè¿‡è¿™ä¸€éƒ¨åˆ†æ¯”èµ›è¿‡ç¨‹ï¼Œæ±‚å‡ºé‚£ä¸€å¹´æœ‰å‡ æ”¯é˜Ÿä¼çš„æ’åæ˜¯ç¡®å®šçš„ã€‚
>
>  æ³¨â‘ ï¼š20142014 å¹´ä¸¾åŠäº†æœ€åä¸€å±Šæ¯”èµ›ï¼Œä¹‹åæ¥¼é•¿è¾èŒï¼Œå„ç§æ´»åŠ¨å’Œç¦åˆ©å…¨éƒ¨æ¶ˆå¤±äº†ã€‚

ç¡®å®šæ’åå³ç¡®å®šåœ¨è¯¥å¯¹å‰é¢æœ‰å¤šå°‘äººï¼Œåé¢å¤šå°‘äºº

å¯é€šè¿‡Floydåˆ¤æ–­ä»»æ„ä¸¤ç‚¹æ˜¯å¦å¯è¾¾

```cpp
#define MAX_N 100

int n, m, ans[MAX_N + 5][MAX_N + 5];
int l[MAX_N + 5], r[MAX_N + 5];

int main() {
    memset(ans, 0x3f, sizeof(ans));
    cin >> n >> m;
    for (int i = 0, u, v; i < m; i++) {
        cin >> u >> v;
        ans[u][v] = 1;
    }
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= n; j++) {
            for(int k = 1; k <= n; k++) {
                ans[j][k] = min(ans[j][k], ans[j][i] + ans[i][k]);
            }
        }
    }
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= n; j++) {
            if (ans[i][j] == 0x3f3f3f3f) continue;
            l[i]++;
            r[j]++;
        }
    }
    int res = 0;
    for (int i = 1; i <= n; i++) {
        if (l[i] + r[i] == n - 1) res++;
    }
    cout << res << endl;
    return 0;
}

```

#### HZOJ-æ’åº

>  ä¸€ä¸ªä¸åŒçš„å€¼çš„å‡åºæ’åºæ•°åˆ—æŒ‡çš„æ˜¯ä¸€ä¸ªä»å·¦åˆ°å³å…ƒç´ ä¾æ¬¡å¢å¤§çš„åºåˆ—ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªæœ‰åºçš„æ•°åˆ— *ğ´*,*ğµ*,*ğ¶*,*ğ·*A,B,C,D è¡¨ç¤º *ğ´*<*ğµ*,*ğµ*<*ğ¶*,*ğ¶*<*ğ·*A<B,B<C,C<Dã€‚åœ¨è¿™é“é¢˜ä¸­ï¼Œæˆ‘ä»¬å°†ç»™ä½ ä¸€ç³»åˆ—å½¢å¦‚ *ğ´*<*ğµ*A<B çš„å…³ç³»ï¼Œå¹¶è¦æ±‚ä½ åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿæ ¹æ®è¿™äº›å…³ç³»ç¡®å®šè¿™ä¸ªæ•°åˆ—çš„é¡ºåºã€‚
>
>  ------
>
>  #### è¾“å…¥
>
>  ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° *ğ‘›*,*ğ‘š*n,mã€‚*ğ‘›*n è¡¨ç¤ºéœ€è¦æ’åºçš„å…ƒç´ æ•°é‡ï¼Œç¬¬ 11 åˆ° *ğ‘›*n ä¸ªå…ƒç´ å°†ç”¨å¤§å†™çš„ *ğ´*,*ğµ*,*ğ¶*,*ğ·*A,B,C,D....è¡¨ç¤ºã€‚*ğ‘š*m è¡¨ç¤ºå°†ç»™å‡ºçš„å½¢å¦‚ *ğ´*<*ğµ*A<B çš„å…³ç³»çš„æ•°é‡ã€‚
>
>  æ¥ä¸‹æ¥æœ‰ *ğ‘š*m è¡Œï¼Œæ¯è¡Œæœ‰ 33 ä¸ªå­—ç¬¦ï¼Œåˆ†åˆ«ä¸ºä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œä¸€ä¸ª << ç¬¦å·ï¼Œä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œè¡¨ç¤ºä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„å…³ç³»ã€‚
>
>  #### è¾“å‡º
>
>  è‹¥æ ¹æ®å‰ *ğ‘¥*x ä¸ªå…³ç³»å³å¯ç¡®å®šè¿™ *ğ‘›*n ä¸ªå…ƒç´ çš„é¡ºåº *ğ‘¦**ğ‘¦**ğ‘¦*..*ğ‘¦*yyy..yï¼ˆå¦‚*ğ´**ğµ**ğ¶*ABCï¼‰ï¼Œè¾“å‡º
>
>  Sorted sequence determined after xxx relations: yyy...y.
>
>  è‹¥æ ¹æ®å‰ *ğ‘¥*x ä¸ªå…³ç³»å³å‘ç°å­˜åœ¨çŸ›ç›¾ï¼ˆå¦‚ *ğ´*<*ğµ*,*ğµ*<*ğ¶*,*ğ¶*<*ğ´*A<B,B<C,C<Aï¼‰ï¼Œè¾“å‡º
>
>  Inconsistency found after xxx relations.
>
>  è‹¥æ ¹æ®è¿™ *ğ‘š*m ä¸ªå…³ç³»æ— æ³•ç¡®å®šè¿™ *ğ‘›*n ä¸ªå…ƒç´ çš„é¡ºåºï¼Œè¾“å‡º
>
>  Sorted sequence cannot be determined.
>
>  ï¼ˆæç¤ºï¼šç¡®å®š *ğ‘›*n ä¸ªå…ƒç´ çš„é¡ºåºåå³å¯ç»“æŸç¨‹åºï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ç¡®å®šé¡ºåºä¹‹åå‡ºç°çŸ›ç›¾çš„æƒ…å†µï¼‰

```cpp
const int MAX_N = 26;
const char BEGIN_LETTER = 'A';

int n, m;
int ans[MAX_N + 5][MAX_N + 5], matrix[MAX_N + 5][MAX_N + 5];
int l[MAX_N + 5], r[MAX_N + 5], in_degree[MAX_N + 5];
char seq[MAX_N + 5];

int haveCycle(int n) {
    memset(in_degree, 0, sizeof(in_degree));
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            if (matrix[i][j]) in_degree[j]++;
        }
    }
    queue<int> que;
    for (int i = 0; i < n; i++) {
        if (in_degree[i] == 0) que.push(i);
    }
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        for (int i = 0; i < n; i++) {
            if (matrix[now][i] == 0) continue;
            in_degree[i]--;
            if (in_degree[i] == 0) que.push(i);
        }
    }
    for (int i = 0; i < n; i++) {
        if (in_degree[i]) return 1;
    }
    return 0;
}

int floyed(int n) {
    memset(ans, 0x3f, sizeof(ans));
    memset(l, 0, sizeof(l));
    memset(r, 0, sizeof(r));
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            if (matrix[i][j]) ans[i][j] = 1;
        }
    }
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            for (int k = 0; k < n; k++) {
                ans[j][k] = min(ans[j][k], ans[j][i] + ans[i][k]);
            }
        }
    }
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            if (ans[i][j] == 0x3f3f3f3f) continue;
            r[i]++;
            l[j]++;
        }
    }
    int cnt = 0;
    for (int i = 0; i < n; i++) {
        if (r[i] + l[i] == n - 1) cnt++;
        seq[l[i]] = i + BEGIN_LETTER;
    }
    seq[n] = '\0';
    return cnt == n;
}

int main() {
    cin >> n >> m;
    char str[10];
    int flag = 0, ind = -1;
    for (int i = 0; i < m; i++) {
        cin >> str;
        if (flag) continue;
        matrix[str[0] - BEGIN_LETTER][str[2] - BEGIN_LETTER] = 1;
        if (haveCycle(n)) {
            flag = 1;
            ind = i + 1;
        }
        if (floyed(n)) {
            flag = 2;
            ind = i + 1;
        }
    }
    if (flag == 0) {
        cout << "Sorted sequence cannot be determined." << endl;
    } else if (flag == 1) {
        cout << "Inconsistency found after "<< ind << " relations." << endl;
    } else {
           cout << "Sorted sequence determined after " << ind << " relations: " << seq << "." << endl;
    }
    return 0;
}

```





#### HZOJ-==638. æœ€é•¿è·¯==

> ç»™å®šä¸€ä¸ªæœ‰ *ğ‘*N ä¸ªç‚¹çš„æœ‰å‘å¸¦æƒæ— ç¯å›¾ï¼Œç°æ±‚ä» 11 å·ç‚¹åˆ° *ğ‘*N å·ç‚¹çš„æœ€é•¿è·¯å¾„ã€‚

åˆ¤æ–­æ˜¯å¦å¯è¾¾ï¼Œä»¥åŠå¦‚ä½•æ±‚æœ€é•¿è·¯

------

```cpp
int bellman(int start) {
    memset(mask, false, sizeof(mask));
    queue<int> que;
    que.push(start);
    mask[start] = true;
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        mask[start] = false;
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v;
            if (v == n) return 0;
            if (mask[v]) continue;
            mask[v] = true;
            que.push(v);
        }
    }
    return 1;
}

int main() {
    init();
    scanf("%d%d", &n, &m);
    for (int i = 0, u, v, w; i < m; i++) {
        scanf("%d%d%d", &u, &v, &w);
        addEdge(u, v, w);
        in_degree[v]++;
    }
    if (bellman(1)) {
        cout << -1 << endl;
        return 0;
    }
    queue<int> que;
    for (int i = 1; i <= n; i++) {
        if (in_degree[i] == 0) que.push(i);
    }
    dist[1] = 0;
    while (!que.empty()) {
        int now = que.front();
        que.pop();
        for (int i = head[now]; i != -1; i = e[i].next) {
            int v = e[i].v, w = e[i].w;
            dist[v] = max(dist[v], dist[now] + w);
            in_degree[v]--;
            if (in_degree[v] == 0) que.push(v);
        }
    }
    printf("%d\n", dist[n]);
    return 0;
}

```



## å›¾è®º

### å¼ºè¿é€šåˆ†é‡åˆ†è§£

```
å¼ºè¿é€šåˆ†é‡åˆ†è§£å¯ä»¥é€šè¿‡ä¸¤æ¬¡DFSå®ç°ã€‚ç¬¬ä¸€æ¬¡DFSæ—¶ï¼Œé€‰å–ä»»æ„é¡¶ç‚¹ä½œä¸ºèµ·ç‚¹ï¼Œéå†æ‰€æœ‰å°šæœªè®¿é—®è¿‡çš„é¡¶ç‚¹ï¼Œå¹¶åœ¨å›æº¯å‰ç»™é¡¶ç‚¹æ ‡å·ã€‚å¯¹å‰©ä½™å°šæœªè®¿é—®è¿‡çš„é¡¶ç‚¹ä¸æ–­é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚å®Œæˆæ ‡å·åï¼Œè¶Šæ¥è¿‘å›¾çš„å°¾éƒ¨ï¼Œé¡¶ç‚¹çš„æ ‡å·è¶Šå°ã€‚ç¬¬äºŒæ¬¡DFSæ—¶ï¼Œå…ˆå°†æ‰€æœ‰è¾¹åå‘ï¼Œç„¶åä»¥æ ‡å·æœ€å¤§çš„é¡¶ç‚¹ä¸ºèµ·ç‚¹è¿›è¡ŒDFSã€‚è¿™æ ·DFSæ‰€éå†çš„é¡¶ç‚¹é›†åˆå°±æ„æˆäº†ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ã€‚ä¹‹åï¼Œåªè¦è¿˜æœ‰å°šæœªè®¿é—®çš„é¡¶ç‚¹ï¼Œå°±ä»ä¸­é€‰å–æ ‡å·æœ€å¤§çš„é¡¶ç‚¹ä¸æ–­é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚æ±‚å›¾çš„å¼ºè¿é€šåˆ†é‡éå¸¸é‡è¦ï¼Œéœ€è¦ç†Ÿæ‚‰ä»£ç ï¼š
```

###  2-SAT

```
ç»™å®šä¸€ä¸ªboolæ–¹ç¨‹ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ç»„å¸ƒå°”å˜é‡çš„çœŸå€¼æŒ‡æ´¾ä½¿æ•´ä¸ªæ–¹ç¨‹ä¸ºçœŸçš„é—®é¢˜ï¼Œç§°ä¸ºå¸ƒå°”æ–¹ç¨‹çš„å¯æ»¡è¶³æ€§é—®é¢˜ï¼ˆSATï¼‰ï¼Œè¯¥é—®é¢˜æ˜¯ä¸€ä¸ªNPé—®é¢˜ã€‚åˆå–èŒƒå¼å¦‚ä¸‹ï¼š
```

å¦‚æœåˆå–èŒƒå¼ä¸­çš„æ¯ä¸ªå­å¥ä¸­çš„å˜é‡ä¸ªæ•°éƒ½ä¸è¶…è¿‡ä¸¤ä¸ªï¼Œåˆ™å¯¹åº”çš„SATé—®é¢˜åˆè¢«ç§°ä¸º2-SATé—®é¢˜ï¼Œè¯¥é—®é¢˜å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…è§£å†³ã€‚
       è§£å†³æ–¹æ³•æ˜¯åˆ©ç”¨è•´å«æ“ä½œ å°†æ¯ä¸ªå­å¥ æ”¹ä¸º è¿™æ ·åŸå¸ƒå°”å…¬å¼å°±å˜æˆåªæœ‰ä¸è¿ç®—çš„å…¬å¼ï¼Œæ¯ä¸€ä¸ªå­å¥éƒ½æ˜¯ä¸€ä¸ªè•´å«è¿ç®—ã€‚å¯¹æ¯ä¸ªå¸ƒå°”å˜é‡xï¼Œæ„é€ ä¸¤ä¸ªé¡¶ç‚¹åˆ†åˆ«ä»£è¡¨xå’Œ ï¼Œä»¥ å…³ç³»ä¸ºè¾¹å»ºç«‹æœ‰å‘å›¾ã€‚æ­¤æ—¶ï¼Œå¦‚æœå›¾ä¸Šçš„aç‚¹èƒ½å¤Ÿåˆ°è¾¾bç‚¹çš„è¯ï¼Œå°±è¡¨ç¤ºå½“aä¸ºçœŸæ—¶bä¹Ÿä¸€å®šä¸ºçœŸã€‚å› æ­¤ï¼ŒåŒä¸€å¼ºè¿é€šåˆ†é‡ä¸­æ‰€å«çš„æ‰€æœ‰æ–‡å­—çš„å¸ƒå°”å€¼å‡ç›¸åŒã€‚
       å¦‚æœå­˜åœ¨æŸä¸ªå¸ƒå°”å˜é‡xï¼Œxå’Œ å‡åœ¨åŒä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ä¸­ï¼Œåˆ™æ— æ³•ä»¤æ•´ä¸ªå¸ƒå°”å…¬å¼çš„å€¼ä¸ºçœŸã€‚åä¹‹ï¼Œå¯¹äºæ¯ä¸ªå¸ƒå°”å˜é‡xï¼Œè®©  



### LCA

```
LCAé—®é¢˜æ˜¯æ±‚æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆé—®é¢˜ï¼Œé’ˆå¯¹ä¸åŒç±»å‹çš„æ ‘å’Œæ•°æ®ç»“æ„æœ‰ä¸åŒçš„ç®—æ³•ã€‚
```

1)       åŸºäºäºŒåˆ†æœç´¢çš„æ–¹æ³•

       è®°èŠ‚ç‚¹våˆ°æ ¹çš„æ·±åº¦ä¸ºdepth(v)ã€‚é‚£ä¹ˆï¼Œå¦‚æœèŠ‚ç‚¹wæ˜¯uå’Œvçš„å…¬å…±ç¥–å…ˆçš„è¯ï¼Œè®©uå‘ä¸Šèµ°depth(u)-depth(w)ï¼Œè®©vå‘ä¸Šèµ°depth(v)-depth(w)æ­¥ï¼Œéƒ½å°†èµ°åˆ°wã€‚å› æ­¤ï¼Œé¦–å…ˆå°†uå’Œvä¸­è¾ƒæ·±çš„èŠ‚ç‚¹å‘ä¸Šèµ°|depth(u)-depth(v)|ä¸ï¼Œå†ä¸€èµ·ä¸€æ­¥æ­¥å‘ä¸Šèµ°ï¼Œç›´åˆ°èµ°åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯ä»¥åœ¨O(depth(u)+depth(v))æ—¶é—´å†…æ±‚å‡ºLCAã€‚è¿™è¦æ±‚çš„æ•°æ®ç»“æ„å¿…é¡»æœ‰ä¸€ä¸ªparentåŸŸç”¨æ¥æŒ‡ç¤ºçˆ¶èŠ‚ç‚¹ï¼Œæ­¤å¤–æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæ·±åº¦ä¿¡æ¯ã€‚

2)       åŸºäºRMQçš„ç®—æ³•

é¦–å…ˆï¼ŒæŒ‰ä»æ ¹DFSè®¿é—®çš„é¡ºåºå¾—åˆ°é¡¶ç‚¹åºåˆ—vs[i]å’Œå¯¹åº”çš„æ·±åº¦depth[i]ã€‚å¯¹äºæ¯ä¸ªé¡¶ç‚¹vï¼Œè®°å…¶åœ¨vsä¸­é¦–æ¬¡å‡ºç°çš„ä¸‹æ ‡ä¸ºid[i]ã€‚è¿™äº›éƒ½å¯ä»¥åœ¨O(n)çš„æ—¶é—´å†…æ±‚å¾—ã€‚è€ŒLCA(uï¼Œv)å°±æ˜¯è®¿é—®uä¹‹ååˆ°è®¿é—®vä¹‹å‰æ‰€ç»è¿‡é¡¶ç‚¹ä¸­ç¦»æ ¹æœ€è¿‘çš„é‚£ä¸ªã€‚å‡è®¾id[u]<=id[v]ï¼Œé‚£ä¹ˆæœ‰

LCA(u,v)=vs[id[u]<=i<=id[v]ä¸­ä»¤depth(i)æœ€å°çš„i]

è€Œè¿™å˜æˆäº†ä¸€ä¸ªåŒºé—´æœ€å°å€¼æŸ¥è¯¢é—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨RMQé«˜æ•ˆåœ°æ±‚è§£ã€‚å…³äºRMQçš„æ±‚è§£ï¼Œå¤§å®¶å¯ä»¥æŸ¥é˜…ç½‘ä¸Šå…³äºRMQçš„STç®—æ³•ã€‚

       é’ˆå¯¹LCAé—®é¢˜ï¼Œè¿˜æœ‰å¹¶æŸ¥é›†+dfsçš„tarjanç®—æ³•ï¼Œæ›´è¯¦ç»†çš„èµ„æ–™å¯å‚è€ƒï¼šäºŒå‰æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚


## 
