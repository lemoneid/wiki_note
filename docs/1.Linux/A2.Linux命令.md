---
id : A2.Linux命令
title : A2.Linux命令
typora-root-url : ../
---

[TOC]

# Linux命令



# 命令系统

## shell、terminal和console

> `shell`是一种命令接下，它给用户提供一个输入命令并接受机器返回结果的界面。 `bash`是`shell`中的一种
>
> `terminal` 终端，是一个封装的程序,一个terminal运行一个shell来扩充功能
>
> `console` 一般只能有一个(显示器或电脑用串口线连接)



```mermaid
graph LR
	A(Keyboard) --# stdin--- B((Program))
    B--# 1stdout--- C(display)
 	B--# 2stdout--- C(display)
```

keyboard + display = Text terminal

> terminal 是黑框框，bash 是执行的`root@aliyun:~# `

## Linux帮助手册

`tldr` 常用命令，需联网，但有时超时，不可用

`command -h或--help`  部分命令有帮助信息来自man手册

### man使用方法

`man -k `	查找关键字 可以  eg: 	`man -k reboot | grep reboot`

`man -f`     查找 find

```shell
yanzhiwei@aliyun:~$ man -f tty
tty (1)              - print the file name of the terminal connected to standard input
tty (4)              - controlling terminal
yanzhiwei@aliyun:~$ man 1 tty
```



### man手册各部分

```shell
LS(1)                             							UserCommands                              LS(1)

NAME  #命令全面，简单的说明及用法
       ls - list directory contents

SYNOPSIS #基本语法
       ls [OPTION]... [FILE]...  #[OPTION]...  []表示可有可无   ...表示多个参数

DESCRIPTION  #详细说明语法中参数的用法
#省略
Exit status:  #错误返回值
       0      if OK,

       1      if minor problems (e.g., cannot access subdirectory),

AUTHOR	#作者
       Written by Richard M. Stallman and David MacKenzie.

REPORTING BUGS  #bug提交方式
       GNU coreutils online help: <http://www.gnu.org/software/coreutils/>

COPYRIGHT  #版权保护
       Copyright  © 2017 Free Software Foundation, Inc.  

SEE ALSO  #在哪可看到更多关于该命令的文档
       Full documentation at: <http://www.gnu.org/software/coreutils/ls>
       or available locally via: info '(coreutils) ls invocation' 


```

### man手册命令含义

| 序号  | 含义                                                         | eg         |
| ----- | ------------------------------------------------------------ | ---------- |
| 1     | 1.用户在shell环境中可以操作的指令或可执行文件；              | ls         |
| 2     | 2.系统核心可呼叫的函数与工具等；                             | reboot     |
| 3     | 3，一些常用的函数与函数库，大部委为C的函数库                 | readdir    |
| 4     | 4，装置档案的说明，通常在/dev下的档案；                      | null       |
| 5     | 5，配置文件或者是某些档案的格式；                            | interfaces |
| 6     | 6，游戏；                                                    | lol        |
| 7     | 7.惯例与协议等，例如linux文件系统、网络协议、ASCII code等等的说明； | tcp        |
| 8     | 8.系统管理员可用的管理指令；                                 | reboot     |
| 9     | 9.跟kernel有关的文件。                                       |            |
| o,n,l | 依次为 旧、新、本地文档                                      |            |



| man手册快捷键                    | 功能               | 快捷键 | 功能  |
| -------------------------------- | ------------------ | ------ | ----- |
| 翻页                             | space              | 下一行 | Enter |
| /                                | 查找               | q(uit) | 退出  |
| Ctrl + f(orward),b(ackward) | 向下翻一页，上 |        |       |
| Ctrl+d(won),u(p)                 | 向下翻半页，上     |        |       |



## Bash

**`seq`命令**用于产生从某个数到另外一个数之间的所有整数。

```shell
for i in `seq 1 20 `; do   #执行二十次命令 
touch test$i    #创建文件
done 
```

#### 历史命令

- `history`

  ```shell
    186  eixt
    187  logout
    188  history 
  yanzhiwei@aliyun:~$ !188   #执行第118号命令
  ```

  

- 上下箭头

### 通配符

- ？ 单个任意字符

- \*   任意几个任意字符

  | **通配符**            | **含义**                                    | **实例**                                                     |
  | --------------------- | ------------------------------------------- | ------------------------------------------------------------ |
  | *                     | 匹配 0 或多个字符                           | a*b a与b之间可以有任意长度的任意字符, 也可以一个也没有, 如aabcb, axyzb, a012b, ab。 |
  | ?                     | 匹配任意一个字符                            | a?b a与b之间必须也只能有一个字符, 可以是任意字符, 如aab, abb, acb, a0b。 |
  | [list]                | 匹配 list 中的任意单一字符                  | a[xyz]b  a与b之间必须也只能有一个字符, 但只能是 x 或 y 或 z, 如: axb, ayb, azb。 |
  | [!list]或[\^list]     | 匹配 除list 中的任意单一字符                | a[!0-9]b a与b之间必须也只能有一个字符, 但不能是阿拉伯数字, 如axb, aab, a-b。 |
  | [c1-c2]               | 匹配 c1-c2 中的任意单一字符 如：[0-9] [a-z] | a[0-9]b 0与9之间必须也只能有一个字符 如a0b, a1b... a9b。     |
  | [!c1-c2]或[\^c1-c2]   | 匹配不在c1-c2的任意字符                     | a[!0-9]b 如acb adb                                           |
  | {string1,string2,...} | 匹配 sring1 或 string2 (或更多)其一字符串   | a{abc,xyz,123}b 列出aabcb,axyzb,a123b                        |

## 任务管理

1. `&`   在命令后加`&`，表示后台执行

```shell
command &
```

2. `;`   在命令之间以`;`相连，表示顺序执行

```shell
command1;command2
```

3. `&&` 命令之间以`&&`相连，只有command1成功执行，command2才执行      类比C语言语法

```shell
command1 && command2
```

4. `||`命令之间以`||`相连，只有command1执行失败，command2才执行      类比C语言语法

```shell
command1 || command2
```

5. `  ``  `   命令包含\`另一命令\`。\`command\`优先执行，该子命令；将其结果带入父命令继续执行。 

   ```shell
   command `command`
   ```

6. `Ctrl + z`  暂时挂起

```shell
yanzhiwei@aliyun:~/test$ vim a.cpp[1]+  Stopped                 vim a.cpp
```

7. `bg` 将挂起的命令后台运行。 后+任务编号

```shell
[1]+  Stopped                 vim a.cppyanzhiwei@aliyun:~/test$ bg[1]+ vim a.cpp &
```

8. `fg` 将后台执行的命令转为前台执行,默认为最近一次， 与`%`等价   

9. `jobs` 查看所有在后台执行和挂起的任务以及任务编号

### 结束进程

1. `Ctrl + c` 一般结束进程
2. `kill PID `
3. `pkill 进程名称`   注意。尽量在普通用户下kill

#### 查看进程

`ps -ef` 和 `ps -aux`

```shell
yanzhiwei@aliyun:~/test$ ps -efUID        PID  PPID  C STIME TTY          TIME CMDroot         1     0  0 Apr21 ?        00:00:01 /sbin/init noibrs splashroot         2     0  0 Apr21 ?        00:00:00 [kthreadd]root         4     2  0 Apr21 ?        00:00:00 [kworker/0:0H]
```



## 管道、重定向

`echo $? `打印上一条执行命令的返回值，0 为成功

`echo` 英译回声，打印的意思

### llinux中的三种IO设备：

1. 标准输入（STDIN）,文件描述符号为：0，默认从键盘获取输入

2. 标准输出（STDOUT）,文件描述符号位：1，默认输出到显示终端

3. 标准错误（STDERR）,文件描述符号为：2，默认输出到显示终端

典例 

```shell
ping 64 bytes from 220.181.38.148 (220.181.38.148): icmp_seq=4 ttl=52 time=4.05 mskill 64 bytes from 220.181.38.148 (220.181.38.148): icmp_seq=5 ttl=52 time=4.05 ms64 bytes from 220.181.38.148 (220.181.38.148): icmp_seq=6 ttl=52 time=4.08 ms#kill stdin；说明是三个不同文件
```





#### 1. 输出重定向

**标准输出STDOUT和标准错误输出STDERR）**

- `>` 标准输出覆盖重定向        `man ls > ls.log`  没有文件默认新建；`.log`日志  
- `>>` 标准输出追加重定向
- `2>` 标准错误输出重定向
- `2>>` 标准错误输出追加重定向
- `&>` 将标准输出和标准错误输出都同时重定向（相当于二次重定向`2>&1`）
- `&>>` 将标准输出和标准错误输出都同时追加重定向


  #### 2. 输入重定向

**（标准输入）**

- `<` 输入重定向；

  ```shell
  gcc a.c./a.out < input   #input文件为输入的数据
  ```

- `<<END` 多行输入；(END为多行输入的结束标志)通常用于脚本创建新文件时写入固定内容; `END` 就是一个结束符，自定义，`hahah`,`EOF`都行

  ```shell
  yanzhiwei@aliyun:~/test$ cat >> temp <<EOF> sdfas> fd> asdfgadsgsdkjfgfg> EOFyanzhiwei@aliyun:~/test$ cat temp sdfasfdasdfgadsgsdkjfgfg
  ```

  

> 输入输出重定向可同时进行；`./a.out > dir < input` = `./a.out > dir < input`

#### 3.管道

`|` 把前一个命令的执行结果当做后一个命令的输入

### 转义符

让通配符，或者shell'元字符 变成普通字符，不需要使用它。那么这里我们就需要用到转义符了。 shell提供转义符有三种。



| 字符       | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| ‘’(单引号) | 硬转义，其内部所有的shell 元字符、通配符都会被关掉。不允许出现单引号 |
| “”(双引号) | 软转义，其内部只允许出现特定的shell 元字符：$用于参数替换; `(反单引号，esc键下面)用于命令替换;\\用于转义单个字符 |
| \\(反斜杠) | 又叫转义，去除其后紧跟的元字符或通配符的特殊意义             |

```shell
yanzhiwei@aliyun:~/test$ echo '$HOME'$HOMEyanzhiwei@aliyun:~/test$ echo $HOME/home/yanzhiwei
```



#### 转义符对应表



### shell元字符

shell除了有通配符之外，由shell负责预先先解析后，将处理结果传给命令行之外，shell还有一系列自己的其他特殊字符。



| 字符 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| =    | 变量名=值，为变量赋值。注意=左右紧跟变量名和值，中间不要有空格 |
| ``   | 取命令的执行结果， 与下文的$有相似之处                       |
| $    | 变量值替换，\$变量名替换为shell变量的值;为避免在文本连接时混淆，请使用\${变量名};\$0...\$9 代表shell文件的参数。\$()``;\${}限定变量名的范围；\$[]整数的计算； |
| >    | prog > file 将标准输出重定向到文件。                         |
| >>   | prog >> file 将标准输出追加到文件。                          |
| <    | prog < file 从文件file中获取标准输入                         |
| <<   |                                                              |
| \|   | 管道命令，例：p1                                             |
| &    | 后台运行命令，最大好处是无需等待命令执行结束，就可以在同一命令行下继续输入命令 |
| ()   | 在子shell中执行命令                                          |
| {}   | 在当前shell中执行命令，或用在变量替换的界定范围(例如上面的${变量名}用法)。 |
| []   | 字符通配，匹配括号内之一                                     |
| ;    | 命令结束符。例如p1;p2表示先执行p1,再执行p2                   |
| &&   | 前一个命令执行成功后，才继续执行下一个命令。例：p1 && p2 ;若p1执行成功后，才执行p2,反之，不执行p2; |
| \|\| | 前一个命令执行失败后，才继续执行下一个命令。例：p1 \|\| p2 ;若p1执行成功后，不执行p2,反之，才执行p2; |
| !    | 执行历史记录中的命令                                         |
| %    | %1 相当于 fg1                                                |
| ^    | 取非，和！雷同；`^string1^sring2^` 将上一命令的string1替换为string2 |
| ~    | home目录                                                     |
| #    | 注释                                                         |
| *    | 通配符，任意字符                                             |
| ?    | 通配符，任一字符                                             |
| .    | 当前目录； source                                            |
| -    | 减号；上次工作目录                                           |
| :    | 真值；空命令                                                 |
| \    | 转义                                                         |
| /    | 目录分隔符                                                   |



# Linux系统信息

中国时区:东八区

timestamp 时间戳

Unix epoch 计算机元年，1970-01-01

## 基本命令

| 命令   | 功能                       | 命令             | 功能                                    |
| ------ | -------------------------- | ---------------- | --------------------------------------- |
| uptime | 打印系统运行时长和平均负载 | w                | 当前登录用户列表及正在执行的任务        |
| who    | 显示当前登录系统的用户信息 | whoami  who am i | 打印当前有效的用户名称 who am i logname |
| last   | 显示用户最近登录的信息     | uname            | 打印当前系统信息                        |
| date   | 显示或设置系统时间与如期   | cal              | 显示日历                                |

"\$PATH"  软转义，`“ ”` 是为了表明`$PSTH`是一个字符串



### uptime

`uptime [phsv]` 

```shell
yanzhiwei@aliyun:~$ uptime
 09:25:31 up 2 days, 15:06,  1 user,  load average: 0.49, 1.10, 2.32  #用man手册查看代表含义
```

### w

`w [husfv] <user> <...>`

| USER       | TTY                    | FROM       | LOGIN@   | IDLE     | JCPU | PCPU                 | WHAT                   |
| ---------- | ---------------------- | ---------- | -------- | -------- | ---- | -------------------- | ---------------------- |
| 登陆用户名 | 登录后系统分配的终端号 | 远程主机名 | 登录时间 | 空闲时间 | 404  | 当前进程所占用的时间 | 当前进程正在执行的命令 |

>  404: 和终端相连的所有进程占用的时间,包含当前正在执行的后台作业 
>  **Linux一切皆文件**


```shell
yanzhiwei@aliyun:~$ w
 09:34:56 up 2 days, 15:16,  2 users,  load average: 1.02, 1.29, 1.91
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
yanzhiwe pts/0    183.197.57.134   09:25    0.00s  0.05s  0.00s w
root     pts/1    183.197.57.134   09:31    7.00s  0.03s  0.03s -bash

root@aliyun:/dev/pts# echo "hello" > /dev/pts/0    #向另一人发信息; 表明Linux一切皆文件
yanzhiwei@aliyun:~$ hello
```

> w 显示时 公网IP改变 
>
> NAT 网络地址准换方法。 ipv4资源稀缺

`wall 信息` 根据权限发送给其他人信息 

```shell
root@aliyun:~# wall "Hi"       #wall 广播某条信息，普通用户可以发放普通用户，而不可发给root； root 可发给普通用户;
                                                                               
Broadcast message from root@aliyun (pts/1) (Fri Apr 24 10:37:27 2020):         
                                                                               
Hi
#为普通用户
Broadcast message from root@aliyun (pts/1) (Fri Apr 24 10:37:27 2020):         
                                                                               
Hi
```

`pts`类型文件:远程连接时,系统给分配的远程终端

### who

`who`显示登录系统的用户信息

```shell
yanzhiwei@aliyun:~$ sudo -i     #登录用户为yanzhiwe，临时切换为root
[sudo] password for yanzhiwei: 
root@aliyun:~# who
yanzhiwei pts/0        2020-04-24 10:31 (183.197.57.134)
root     pts/1        2020-04-24 10:34 (183.197.57.134)
yanzhiwei pts/2        2020-04-24 10:34 (183.197.57.134)
root@aliyun:~# who
yanzhiwei pts/0        2020-04-24 10:31 (183.197.57.134)
root     pts/1        2020-04-24 10:34 (183.197.57.134)
yanzhiwei pts/2        2020-04-24 10:34 (183.197.57.134)
root@aliyun:~# whoami
root
root@aliyun:~# who am i 
yanzhiwei pts/2        2020-04-24 10:34 (183.197.57.134)
root@aliyun:~# logname
yanzhiwei

```

`id`命令 查看当前系统用户

```shell
root@aliyun:~# id
uid=0(root) gid=0(root) groups=0(root)
root@aliyun:~# id yanzhiwei
uid=1001(yanzhiwei) gid=1001(yanzhiwei) groups=1001(yanzhiwei),27(sudo)
root@aliyun:~# usermod -G sudo yanzhiwei
```

### last

`last <fnx> <username...> < tty..>`

 ```shell
yanzhiwei@aliyun:~$ last   #显示用户最近登录信息
root     pts/2        183.197.237.163  Sat Apr 18 17:15 - 19:32  (02:17)
yzw      pts/1        183.197.237.163  Sat Apr 18 17:00 - 17:00  (00:00)
root     pts/1        183.197.237.163  Sat Apr 18 16:55 - 16:59  (00:04)
reboot   system boot  4.15.0-91-generi Sun Apr 19 00:17 - 18:18 (2+18:01)
reboot   system boot  4.15.0-91-generi Sat Apr 18 23:10 - 16:16  (-6:53)

wtmp begins Sun Mar 29 12:49:47 2020
yanzhiwei@aliyun:~$ last -n 10  #"num"   指定输出记录数
yanzhiwe pts/2        183.197.57.134   Fri Apr 24 10:34   still logged in
root     pts/1        183.197.57.134   Fri Apr 24 10:34   still logged in
yanzhiwe pts/0        183.197.57.134   Fri Apr 24 10:31   still logged in
root     pts/1        183.197.57.134   Fri Apr 24 09:31 - 09:46  (00:14)
yanzhiwe pts/0        183.197.57.134   Fri Apr 24 09:25 - 09:45  (00:20)
root     pts/1        183.197.57.134   Thu Apr 23 18:51 - 18:54  (00:02)
yanzhiwe pts/0        183.197.57.134   Thu Apr 23 17:59 - 22:10  (04:10)
yanzhiwe pts/0        183.197.57.134   Wed Apr 22 21:51 - 00:01  (02:09)
yanzhiwe pts/0        183.197.57.134   Wed Apr 22 19:57 - 21:45  (01:48)
yanzhiwe pts/0        183.197.237.248  Wed Apr 22 08:24 - 13:27  (05:02)

wtmp begins Sun Mar 29 12:49:47 2020                  
yanzhiwei@aliyun:~$ last -f /var/log/wtmp #"file" 指定记录文件
root     pts/1        183.197.237.163  Sat Apr 18 16:37 - 16:43  (00:05)
root     pts/1        183.197.237.163  Sat Apr 18 16:34 - 16:37  (00:02)
root     pts/0        183.197.237.163  Sat Apr 18 16:17 - 18:29  (02:11)
reboot   system boot  4.15.0-91-generi Sun Apr 19 00:17 - 18:18 (2+18:01)
reboot   system boot  4.15.0-91-generi Sat Apr 18 23:10 - 16:16  (-6:53)

wtmp begins Sun Mar 29 12:49:47 2020
yanzhiwei@aliyun:~$ last -x #显示系统关机重启等信息
root     pts/0        183.197.237.163  Sat Apr 18 16:17 - 18:29  (02:11)
runlevel (to lvl 5)   4.15.0-91-generi Sat Apr 18 16:17 - 18:18 (3+02:01)
reboot   system boot  4.15.0-91-generi Sun Apr 19 00:17 - 18:18 (2+18:01)
shutdown system down  4.15.0-91-generi Sat Apr 18 16:16 - 00:17  (08:00)
runlevel (to lvl 5)   4.15.0-91-generi Sat Apr 18 15:10 - 16:16  (01:06)
reboot   system boot  4.15.0-91-generi Sat Apr 18 23:10 - 16:16  (-6:53)
shutdown system down  4.15.0-91-generi Sun Mar 29 12:49 - 23:10 (20+10:20)

wtmp begins Sun Mar 29 12:49:47 2020
 ```

### uname

`uname <a> `

```shell
yanzhiwei@aliyun:~$ uname -a  #系统、主机名，内核版本，系统发行版本及时间，系统架构，处理器架构，硬件架构，系统内核
Linux aliyun 4.15.0-91-generic #92-Ubuntu SMP Fri Feb 28 11:09:48 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux   
yanzhiwei@aliyun:~$ 
```

```shell
yanzhiwei@aliyun:~$ cat /etc/os-release  #realease 发布 
NAME="Ubuntu"
VERSION="18.04.4 LTS (Bionic Beaver)"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 18.04.4 LTS"
VERSION_ID="18.04"
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
VERSION_CODENAME=bionic
UBUNTU_CODENAME=bionic
yanzhiwei@aliyun:~$ cat /etc/hostname  #主机名
aliyun
```

### data

`data <dsu> <参数>`

```shell
yanzhiwei@aliyun:~$ date -d @0   
Thu Jan  1 08:00:00 CST 1970   #计算机元年 我们在东八区，此时格林威治时间为0点
root@aliyun:~# date +%s
1587700847
root@aliyun:~# date +"%Y-%m-%d %H:%M:%S"   #类比于C语言的格式化字符串
2020-04-24 12:00:09
```

> NTP协议 使计算机时间同步化的一种协议

### cal

`cal<13jy> <参数>`

选项 -1，-3:最近一个月三个月； -j: 显示一年的第几天；-y:显示当前年

参数 月：指定月份； 年：指定年份



# 文件与目录

## 目录

| 命令  | 功能     | 命令  | 功能             |
| ----- | -------- | ----- | ---------------- |
| mkdir | 创建目录 | pwd   | 打印当前工作目录 |
| mkdir | 创建目录 | rmdir | 删除目录         |

绝对路径

相对路径

### cd

- `cd /etc`   #绝对路径，直接切换到/etc目录

- cd ..  	

- cd .

- cd ~ #家目录

- cd -  #回到上次工作目录

缺省情况就是默认情况

`env` #打印环境变量

```shell
yanzhiwei@aliyun:~/test$ env  #打印环境变量
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;3
SSH_CONNECTION=183.197.57.134 33984 172.17.62.153 22
LESSCLOSE=/usr/bin/lesspipe %s %s
LANG=en_US.UTF-8
DISPLAY=localhost:10.0
S_COLORS=auto
XDG_SESSION_ID=483
USER=yanzhiwei
PWD=/home/yanzhiwei/test
HOME=/home/yanzhiwei
SSH_CLIENT=183.197.57.134 33984 22
SSH_TTY=/dev/pts/0
MAIL=/var/mail/yanzhiwei
TERM=xterm
SHELL=/bin/bash
SHLVL=1
LOGNAME=yanzhiwei
XDG_RUNTIME_DIR=/run/user/1001
PATH=/home/yanzhiwei/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
LESSOPEN=| /usr/bin/lesspipe %s
_=/usr/bin/env
OLDPWD=/home/yanzhiwei
```

### pwd 

`pwd [-LP]`     为了是区分链接

- -L:逻辑工作目录;   链接类似于快捷方式

- -P:物理工作目录;    找到真正目录

```shell
yanzhiwei@aliyun:~$ cd /var/  
yanzhiwei@aliyun:/var$ ls -al run
lrwxrwxrwx 1 root root 4 Mar 29 12:39 run -> /run
yanzhiwei@aliyun:/var$ cd run
yanzhiwei@aliyun:/var/run$ pwd -L
/var/run
yanzhiwei@aliyun:/var/run$ pwd -P
/run
```

### mkdir

`mkdir [pm] \<dir> `

- -p 自动创建父目录
- -m 设置权限

```shell
yanzhiwei@aliyun:~/test$ mkdir 123/456
mkdir: cannot create directory ‘123/456’: No such file or directory
yanzhiwei@aliyun:~/test$ mkdir -p 123/456
yanzhiwei@aliyun:~/test$ ls
123    man_ls  
yanzhiwei@aliyun:~/test$ cd 123
yanzhiwei@aliyun:~/test/123$ ls
456
yanzhiwei@aliyun:~/test/123$ mkdir -m 0777 345
yanzhiwei@aliyun:~/test/123$ ls
345  456
yanzhiwei@aliyun:~/test/123$ ls -ald 345   # -d 列出目录本身，而不是内容
drwxrwxrwx 2 yanzhiwei yanzhiwei 4096 Apr 24 20:33 345
```

权限 mod = 777 会显示为高亮，例如上面懂得 /345

### rmdir

`rmdir [p] \<dir>`



> PATH="$PATH":/home/yanzhiwei/bin    # " " 为软转义 这里只是为强调是字符串； 变量赋值

``` shell
yanzhiwei@aliyun:~/test$ a=b
yanzhiwei@aliyun:~/test$ echo b
b
yanzhiwei@aliyun:~/test$ echo {a}a
{a}a
yanzhiwei@aliyun:~/test$ echo ${a}a
ba
yanzhiwei@aliyun:~/test$ echo $a:a
b:a
```

## 文件与目录的管理

| 命令     | 功能               | 命令    | 功能     |
| -------- | ------------------ | ------- | -------- |
| ls       | 显示文件及目录信息 | cp      | 拷贝     |
| rm       | 删除               | mv      | 移动     |
| basename | 取文件名           | dirname | 取目录名 |

### ls

`ls <aldh> `

- `-d <file>` 显示目录本身, 而非内容
- `-h  human `以符合人类的方式看

```shell
yanzhiwei@aliyun:~/test$ ls -ald .
drwxrwxr-x 3 yanzhiwei yanzhiwei 4096 Apr 24 20:32 .
yanzhiwei@aliyun:~/test$ ls -aldh .
drwxrwxr-x 3 yanzhiwei yanzhiwei 4.0K Apr 24 20:32 .
```



### cp

`cp [irapdslu] <sour> <des>`

- -i 若文件存在，询问用户
- -r 递归复制
- -a pdr的集合
- -p  连同文件属性cp
- -d 若源文件为连接文件的属性，则复制连接文件的属性
- -u 原文件比目的文件新才cp



### rm   (remove 移除)

`rm [irf] <dri_or_file>`

- -f force 强制

> 一般`-f` format、file、force

### mv

`mv [ifu] <source...> <dest>` 可用于重命名

`mv source1 source2 source3 dir` 必须为dir目录

### dirname 和 basename

```shell
yanzhiwei@aliyun:~/test/123$ dirname /test/123/456
/test/123
yanzhiwei@aliyun:~/test/123$ basename /test/123/456
456

```

> 用于文件路径和名称的获取

`dirname`和`basename `不需要参数文件真实存在

## 文件内容的查阅

| 命令 | 功能                   | 命令 | 功能                       |
| ---- | ---------------------- | ---- | -------------------------- |
| cat  | 正向连续读             | tac  | 反向连续读                 |
| nl   | 输出行号显示文件       | od   | 以二进制方式查看文件内容   |
| more | 一页一页的显示文件内容 | less | 类似于more，但可以上下翻看 |
| tail | 只看末尾的几行         | head | 只看头几行                 |

### cat

`cat [-AbEbTv] <file>`

- -A 相当于-vET
- -v 列出看不出的字符，类似于vim可视模式； vim中 `:set list`
- -E 显示断行符为$
- -T 显示TAB为^I
- -b 显示行号，不包括空行
- -n  连同空行列出行号

### nl

`nl [-bnw] \<file>`

- -b a :相当于 cat -n
- -b t :相当于 cat -b
- -n ln，rn，rz :屏幕最左，字段最右，字段最右显示同时前面自动补全0
- -w `<num>`  :行号所占位数

### more

`more <file>`

- /string 向下查找string关键字
- :f  显示文件名称和当前显示的行数
- q 离开

### less

`less <file>`

- /string 向下查找;  n : 继续向下
- /?string 反向查找;  N: 继续反向

### head

`head [-n num] <file>`

- `-n num` : 显示文件前num行
- `-n -num` :除去后num行，都显示

### tail

`tail [-n num] <file>`

- `-n num` : 显示文件后num行
- `-n -num` :除去前num行，都显示

查看一个文件的第116行到120行

```shell
yanzhiwei@aliyun:~/test/123$ man ls | nl -b a -w 5 -n rz | head -n 120 | tail -n 5
00116	       -N, --literal
00117	              print entry names without quoting
00118	
00119	       -o     like -l, but do not list group information
00120	
```



## 修改文件时间与新建文件

### 文件的三个时间

- mtime	 modify    默认，内通数据改动时才更新
- ctime      change   文件的权限， 属性改动时更新
- atime      access    文件的内容被取用access时，更新

```shell
(base) worst@worst:~/2.code$ ls -l --time=ctime   / dir    ## 默认为mtime， --time只可=ctime或atime
总用量 16
drwxr-xr-x 10 worst worst 4096 7月  25  2019 1.暑期集训营
drwxr-xr-x  2 worst worst 4096 7月  23  2019 2.python
drwxr-xr-x  2 worst worst 4096 4月  27 22:22 3.测试
drwxr-xr-x  6 worst worst 4096 10月 19  2019 4.日常

```



### touch

​	`touch  <-acdmt] <file>`    主要用于修改时间,一般就是创建空白文件.

- -a:仅修改访问时间 



## 文件隐藏属性

### chattr

`chattr [ +-= ] [ ASacdistu ] <f ile_or_dir >`

- A : 不修改atime, 节省磁盘，避免忙碌
- S : 同步写入。写入磁盘，再返回；程序到磁盘中间有 缓冲写（内核写入磁盘），超过块(4k)再写入；--> 数据库，保证数据一致性。
- a : append(追加),只能增加数据； --> 适合用于日志，防止删除
- c : 自动压缩,解压 --> 主要用于备份系统中
- d: 不会被dump程序备份
- i : 不能删除、修改、建立连接 --> 若删除，先删除权限
- s : 文件删除时, 直接从磁盘删除  --> 用于敏感数据
- u : 文件删除时, 数据内容存在磁盘中 --> 默认，很高效

### lsattr

`lsattr [-adR] <file_or_dir>`

- -a : 打印隐藏文件的隐藏属性
- -d : 如果是目录，仅打印目录的信息
- -R ：递归

```shell
(base) worst@worst:~/4.test$ touch a
(base) worst@worst:~/4.test$ ll
总用量 16
drwxr-xr-x  2 worst worst 4096 4月  28 14:39 ./
drwxr-xr-x 54 worst worst 4096 4月  28 09:13 ../
-rw-r--r--  1 worst worst    0 4月  28 14:39 a
-rwxr-xr-x  1 worst worst   65 4月  28 08:36 first.sh*
-rwxr-xr-x  1 worst worst  230 4月  28 08:35 test.sh*
(base) worst@worst:~/4.test$ chattr +a a  # 只可追加
chattr: 不允许的操作 设置 a 的标志时
(base) worst@worst:~/4.test$ sudo !!     ## 执行上一次命令
sudo chattr +a a
[sudo] worst 的密码： 
(base) worst@worst:~/4.test$ lsattr -a a
-----a--------e--- a
(base) worst@worst:~/4.test$ vim a
(base) worst@worst:~/4.test$ echo a > a  #不可覆盖
bash: a: 不允许的操作
(base) worst@worst:~/4.test$ echo a >> a
(base) worst@worst:~/4.test$ cat a
a

```



## ==**文件的特殊权限**==

| 权限       | 粘滞位 | 作用对象               | 效果                                   |
| ---------- | ------ | ---------------------- | -------------------------------------- |
| set_uid    | s      | 二进制程序文件，非脚本 | 用户在执行改程序是获取程序所有者权限   |
| set_gid    | s      | 目录和二进制程序文件   | 用户在该目录里，有效组变为目录所属组   |
| sticky bit | t      | 目录                   | 在该目录里，用户只能删除自己创建的内容 |

| u    | 粘   |      | g    | 滞   |      | o    | 位   |      |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| r    | w    | x    | r    | w    | x    | r    | w    | x    |
| x    | ->   | s    | 后   | 面   | 同   | 理   |      |      |
| 无x  | ->   | S    | 原来 | 有   | x    | 则   | 小   | 写   |

set_uid    password修改

set_gid

![image-20200428145233838](/Image/A2.Linux命令-photo/image-20200428145233838-1623667342643.png)

## 命令与文件的查询

| 命令   | 功能                   | 命令    | 功能           |
| ------ | ---------------------- | ------- | -------------- |
| which  | 寻找执行文件           | whereis | 寻找特定文件   |
| locate | 搜索文件（可部分查找） | find    | 多样化高级查找 |

### which

查找PATH路径下所有的可执行文件



### whereis

`whereis [-bmsu] <file_or_dir>`      寻找特定文件

- -b ：只查找二进制文件
- -m ：之查找manual路径下的文件
- -s ： 只查找source源文件
- -u ： 查找其他文件

```shell
(base) worst@worst:~/4.test$ whereis stdio
stdio: /usr/include/stdio.h /usr/share/man/man3/stdio.3.gz
(base) worst@worst:~/4.test$ whereis math
math: /usr/include/math.h
```



### locate

`locate [-ir] keyword`      模糊定位， 类似于Windows（Everything），建立索引

- -i ：忽略大小写

- -r ：后面可接正则表达式

- 相关文件： /etc/updatedb.conf   和  /var/lib/mlocate

  `updatedb` 更新数据库，索引更新

```shell
yanzhiwei@aliyun:~/test$ touch Test.txt
yanzhiwei@aliyun:~/test$ locate *est.t
yanzhiwei@aliyun:~/test$ locate *est.txt
yanzhiwei@aliyun:~/test$ ls
123     temp    test11  test14  test17  test2   test4  test7  Test.txt
a.cpp   test1   test12  test15  test18  test20  test5  test8  touch
man_ls  test10  test13  test16  test19  test3   test6  test9
yanzhiwei@aliyun:~/test$ updatedb
updatedb: can not open a temporary file for `/var/lib/mlocate/mlocate.db'
yanzhiwei@aliyun:~/test$ sudo updatedb   #更新数据库，
[sudo] password for yanzhiwei: 
yanzhiwei@aliyun:~/test$ locate *est.txt
/home/yanzhiwei/test/Test.txt
```



### find

`find [PATH] [option] [action]`

与时间相关 -atime，-ctime， -mtime

- -mtime n ： n天前的"一天之内"修改的文件
- -mtime +n ：n天前，不包含n，修改过的文件
- -mtime -n ：n天之内，包含n，修改过的文件
- -newer file ：比file还要新的文件

与用户或用户组相关的参数：

- -uid n ：用户UID为n
- -gid n ： 群组GID为n
- -user name ：用户名为name
- -group name ：群组名为name
- nouser ： 文件所有者不存在
- nogroup ：文件所在组不存在

与文件权限及名称相关

- -name filename ：文件名为filename
- -size [+-] SIZE ：查找比SIZE大或小的
- -type TYPE ：f b c d l s p
- -perm mode ：mode 刚好等于的文件
- -perm -mode ：全部包含mode的文件           查找指定权限的文件

```shell
(base) worst@worst:~/2.code$ find -exec ls -l {} \;
总用量 16
drwxr-xr-x 10 worst worst 4096 7月  25  2019 1.暑期集训营
drwxr-xr-x  2 worst worst 4096 7月  14  2019 2.python
drwxr-xr-x  2 worst worst 4096 4月  27 22:22 3.测试
drwxr-xr-x  6 worst worst 4096 10月 19  2019 4.日常
总用量 16
-rw-r--r-- 1 worst worst 328 7月  10  2019 class.py
-rw-r--r-- 1 worst worst 320 7月  10  2019 is_prime.py
-rw-r--r-- 1 worst worst 420 7月  10  2019 prime_shai.py
-rw-r--r-- 1 worst worst 350 7月  10  2019 test.py
```

```shell
yanzhiwei@aliyun:~/test$ find ~ -mtime -4 -type f 2>/dev/null
/home/yanzhiwei/.cache/ctrlp/mru/cache.txt
/home/yanzhiwei/1.code/EP01-2.c
/home/yanzhiwei/1.code/EP01-1.c
/home/yanzhiwei/1.code/EP06-1.c
/home/yanzhiwei/1.code/a.out
/home/yanzhiwei/1.code/test.cpp
/home/yanzhiwei/1.code/scan.c
/home/yanzhiwei/1.code/1.test.c

```

```shell
yanzhiwei@aliyun:~/test$ find ~ -mtime -3 -type f -user yanzhiwei -size -1024 -name "*.c" 2>/dev/null
/home/yanzhiwei/1.code/EP01-2.c
/home/yanzhiwei/1.code/EP01-1.c
/home/yanzhiwei/1.code/EP06-1.c
/home/yanzhiwei/1.code/scan.c
/home/yanzhiwei/1.code/1.test.c
/home/yanzhiwei/1.code/printf.c
```

```shell
yanzhiwei@aliyun:~/test$ find ~ -mtime -3 -type f -user yanzhiwei -size -1024 -name "*.c" -perm -644 2>/dev/null | xargs ls -al    #xargs   转换参数， stdin获取转到参数
-rw-rw-r-- 1 yanzhiwei yanzhiwei 448 Apr 25 18:14 /home/yanzhiwei/1.code/1.test.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 494 Apr 25 18:38 /home/yanzhiwei/1.code/EP01-1.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 465 Apr 25 18:43 /home/yanzhiwei/1.code/EP01-2.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 435 Apr 25 18:53 /home/yanzhiwei/1.code/EP06-1.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 434 Apr 25 15:35 /home/yanzhiwei/1.code/printf.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 388 Apr 25 15:50 /home/yanzhiwei/1.code/scan.c
yanzhiwei@aliyun:~/test$ find ~ -mtime -3 -type f -user yanzhiwei -size -1024 -name "*.c" -perm -644 2>/dev/null -exec ls -l {} \;   # -exec执行， {}用于替换替换内容，\; 转义：需要; 而不是顺序执行
-rw-rw-r-- 1 yanzhiwei yanzhiwei 465 Apr 25 18:43 /home/yanzhiwei/1.code/EP01-2.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 494 Apr 25 18:38 /home/yanzhiwei/1.code/EP01-1.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 435 Apr 25 18:53 /home/yanzhiwei/1.code/EP06-1.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 388 Apr 25 15:50 /home/yanzhiwei/1.code/scan.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 448 Apr 25 18:14 /home/yanzhiwei/1.code/1.test.c
-rw-rw-r-- 1 yanzhiwei yanzhiwei 434 Apr 25 15:35 /home/yanzhiwei/1.code/printf.c

```

`xargs`
